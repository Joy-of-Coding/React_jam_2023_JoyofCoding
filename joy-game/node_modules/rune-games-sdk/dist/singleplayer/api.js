/*
Copyright (c) 2022 Rune AI Inc.
All rights reserved.

This code is proprietary to Rune AI Inc.
The code may be used solely for accessing the Service provided by Rune AI Inc. following the Rune Terms of Service ("Terms") accessible at rune.ai/eula. You may not use this code for any use or purpose other than as expressly permitted by the Terms.
Restrictions set forth in the Terms include, but is not limited to, that you may not copy, adapt, modify, prepare derivative works based upon, distribute, license, sell, transfer, publicly display, publicly perform, transmit, stream, broadcast, attempt to discover any source code, reverse engineer, decompile, dissemble, or otherwise exploit the code as a whole or any portion of the code.
*/
"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}var e,i,r;function n(t,e,i){var r=Math.floor(i/4294967296),n=i;t.setUint32(e,r),t.setUint32(e+4,n)}function o(t,e){return 4294967296*t.getInt32(e)+t.getUint32(e+4)}var s=("undefined"==typeof process||"never"!==(null===(e=null===process||void 0===process?void 0:process.env)||void 0===e?void 0:e.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function a(t){for(var e=t.length,i=0,r=0;r<e;){var n=t.charCodeAt(r++);if(0!=(4294967168&n))if(0==(4294965248&n))i+=2;else{if(n>=55296&&n<=56319&&r<e){var o=t.charCodeAt(r);56320==(64512&o)&&(++r,n=((1023&n)<<10)+(1023&o)+65536)}i+=0==(4294901760&n)?3:4}else i++}return i}var h=s?new TextEncoder:void 0,c=s?"undefined"!=typeof process&&"force"!==(null===(i=null===process||void 0===process?void 0:process.env)||void 0===i?void 0:i.TEXT_ENCODING)?200:0:4294967295;var f=(null==h?void 0:h.encodeInto)?function(t,e,i){h.encodeInto(t,e.subarray(i))}:function(t,e,i){e.set(h.encode(t),i)};function u(t,e,i){for(var r=e,n=r+i,o=[],s="";r<n;){var a=t[r++];if(0==(128&a))o.push(a);else if(192==(224&a)){var h=63&t[r++];o.push((31&a)<<6|h)}else if(224==(240&a)){h=63&t[r++];var c=63&t[r++];o.push((31&a)<<12|h<<6|c)}else if(240==(248&a)){var f=(7&a)<<18|(h=63&t[r++])<<12|(c=63&t[r++])<<6|63&t[r++];f>65535&&(f-=65536,o.push(f>>>10&1023|55296),f=56320|1023&f),o.push(f)}else o.push(a);o.length>=4096&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(s+=String.fromCharCode.apply(String,o)),s}var p=s?new TextDecoder:null,d=s?"undefined"!=typeof process&&"force"!==(null===(r=null===process||void 0===process?void 0:process.env)||void 0===r?void 0:r.TEXT_DECODER)?200:0:4294967295;var l,y=function(t,e){this.type=t,this.data=e},w=(l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},l(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),v=function(t){function e(i){var r=t.call(this,i)||this,n=Object.create(e.prototype);return Object.setPrototypeOf(r,n),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:e.name}),r}return w(e,t),e}(Error);var g={type:-1,encode:function(t){var e,i,r,o;return t instanceof Date?function(t){var e,i=t.sec,r=t.nsec;if(i>=0&&r>=0&&i<=17179869183){if(0===r&&i<=4294967295){var o=new Uint8Array(4);return(e=new DataView(o.buffer)).setUint32(0,i),o}var s=i/4294967296,a=4294967295&i;return o=new Uint8Array(8),(e=new DataView(o.buffer)).setUint32(0,r<<2|3&s),e.setUint32(4,a),o}return o=new Uint8Array(12),(e=new DataView(o.buffer)).setUint32(0,r),n(e,4,i),o}((e=t.getTime(),i=Math.floor(e/1e3),r=1e6*(e-1e3*i),o=Math.floor(r/1e9),{sec:i+o,nsec:r-1e9*o})):null},decode:function(t){var e=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:var i=e.getUint32(0);return{sec:4294967296*(3&i)+e.getUint32(4),nsec:i>>>2};case 12:return{sec:o(e,4),nsec:e.getUint32(0)};default:throw new v("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(t.length))}}(t);return new Date(1e3*e.sec+e.nsec/1e6)}},U=function(){function t(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(g)}return t.prototype.register=function(t){var e=t.type,i=t.encode,r=t.decode;if(e>=0)this.encoders[e]=i,this.decoders[e]=r;else{var n=1+e;this.builtInEncoders[n]=i,this.builtInDecoders[n]=r}},t.prototype.tryToEncode=function(t,e){for(var i=0;i<this.builtInEncoders.length;i++){if(null!=(r=this.builtInEncoders[i]))if(null!=(n=r(t,e)))return new y(-1-i,n)}for(i=0;i<this.encoders.length;i++){var r,n;if(null!=(r=this.encoders[i]))if(null!=(n=r(t,e)))return new y(i,n)}return t instanceof y?t:null},t.prototype.decode=function(t,e,i){var r=e<0?this.builtInDecoders[-1-e]:this.decoders[e];return r?r(t,e,i):new y(e,t)},t.defaultCodec=new t,t}();function b(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Uint8Array.from(t)}var m=function(){function e(t,e,i,r,n,o,s,a){void 0===t&&(t=U.defaultCodec),void 0===e&&(e=void 0),void 0===i&&(i=100),void 0===r&&(r=2048),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),this.extensionCodec=t,this.context=e,this.maxDepth=i,this.initialBufferSize=r,this.sortKeys=n,this.forceFloat32=o,this.ignoreUndefined=s,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(t,e){if(e>this.maxDepth)throw new Error("Too deep objects in depth ".concat(e));null===t?this.encodeNil():void 0===t?this.encodeUndefined():"boolean"==typeof t?this.encodeBoolean(t):"number"==typeof t?this.encodeNumber(t):"string"==typeof t?this.encodeString(t):this.encodeObject(t,e)},e.prototype.ensureBufferSizeToWrite=function(t){var e=this.pos+t;this.view.byteLength<e&&this.resizeBuffer(2*e)},e.prototype.resizeBuffer=function(t){var e=new ArrayBuffer(t),i=new Uint8Array(e),r=new DataView(e);i.set(this.bytes),this.view=r,this.bytes=i},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeUndefined=function(){this.writeU8(193)},e.prototype.encodeBoolean=function(t){!1===t?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(t){Number.isSafeInteger(t)&&!this.forceIntegerToFloat?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):(this.writeU8(211),this.writeI64(t)):this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))},e.prototype.writeStringHeader=function(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too long string: ".concat(t," bytes in UTF-8"));this.writeU8(219),this.writeU32(t)}},e.prototype.encodeString=function(t){if(t.length>c){var e=a(t);this.ensureBufferSizeToWrite(5+e),this.writeStringHeader(e),f(t,this.bytes,this.pos),this.pos+=e}else{e=a(t);this.ensureBufferSizeToWrite(5+e),this.writeStringHeader(e),function(t,e,i){for(var r=t.length,n=i,o=0;o<r;){var s=t.charCodeAt(o++);if(0!=(4294967168&s)){if(0==(4294965248&s))e[n++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&o<r){var a=t.charCodeAt(o);56320==(64512&a)&&(++o,s=((1023&s)<<10)+(1023&a)+65536)}0==(4294901760&s)?(e[n++]=s>>12&15|224,e[n++]=s>>6&63|128):(e[n++]=s>>18&7|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128)}e[n++]=63&s|128}else e[n++]=s}}(t,this.bytes,this.pos),this.pos+=e}},e.prototype.encodeObject=function(e,i){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,i);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!==t(e))throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,i)}},e.prototype.encodeBinary=function(t){var e=t.byteLength;if(e<256)this.writeU8(196),this.writeU8(e);else if(e<65536)this.writeU8(197),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too large binary: ".concat(e));this.writeU8(198),this.writeU32(e)}var i=b(t);this.writeU8a(i)},e.prototype.encodeArray=function(t,e){var i=t.length;if(i<16)this.writeU8(144+i);else if(i<65536)this.writeU8(220),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large array: ".concat(i));this.writeU8(221),this.writeU32(i)}for(var r=0,n=t;r<n.length;r++){var o=n[r];this.doEncode(o,e+1)}},e.prototype.countWithoutUndefined=function(t,e){for(var i=0,r=0,n=e;r<n.length;r++){void 0!==t[n[r]]&&i++}return i},e.prototype.encodeMap=function(t,e){var i=Object.keys(t);this.sortKeys&&i.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(t,i):i.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var n=0,o=i;n<o.length;n++){var s=o[n],a=t[s];this.ignoreUndefined&&void 0===a||(this.encodeString(s),this.doEncode(a,e+1))}},e.prototype.encodeExtension=function(t){var e=t.data.length;if(1===e)this.writeU8(212);else if(2===e)this.writeU8(213);else if(4===e)this.writeU8(214);else if(8===e)this.writeU8(215);else if(16===e)this.writeU8(216);else if(e<256)this.writeU8(199),this.writeU8(e);else if(e<65536)this.writeU8(200),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too large extension object: ".concat(e));this.writeU8(201),this.writeU32(e)}this.writeI8(t.type),this.writeU8a(t.data)},e.prototype.writeU8=function(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++},e.prototype.writeU8a=function(t){var e=t.length;this.ensureBufferSizeToWrite(e),this.bytes.set(t,this.pos),this.pos+=e},e.prototype.writeI8=function(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++},e.prototype.writeU16=function(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2},e.prototype.writeI16=function(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2},e.prototype.writeU32=function(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4},e.prototype.writeI32=function(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4},e.prototype.writeF32=function(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4},e.prototype.writeF64=function(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8},e.prototype.writeU64=function(t){this.ensureBufferSizeToWrite(8),function(t,e,i){var r=i/4294967296,n=i;t.setUint32(e,r),t.setUint32(e+4,n)}(this.view,this.pos,t),this.pos+=8},e.prototype.writeI64=function(t){this.ensureBufferSizeToWrite(8),n(this.view,this.pos,t),this.pos+=8},e}(),x={};function S(t){return"".concat(t<0?"-":"","0x").concat(Math.abs(t).toString(16).padStart(2,"0"))}var E=function(){function t(t,e){void 0===t&&(t=16),void 0===e&&(e=16),this.maxKeyLength=t,this.maxLengthPerKey=e,this.hit=0,this.miss=0,this.caches=[];for(var i=0;i<this.maxKeyLength;i++)this.caches.push([])}return t.prototype.canBeCached=function(t){return t>0&&t<=this.maxKeyLength},t.prototype.find=function(t,e,i){t:for(var r=0,n=this.caches[i-1];r<n.length;r++){for(var o=n[r],s=o.bytes,a=0;a<i;a++)if(s[a]!==t[e+a])continue t;return o.str}return null},t.prototype.store=function(t,e){var i=this.caches[t.length-1],r={bytes:t,str:e};i.length>=this.maxLengthPerKey?i[Math.random()*i.length|0]=r:i.push(r)},t.prototype.decode=function(t,e,i){var r=this.find(t,e,i);if(null!=r)return this.hit++,r;this.miss++;var n=u(t,e,i),o=Uint8Array.prototype.slice.call(t,e,e+i);return this.store(o,n),n},t}(),B=function(t,e,i,r){return new(i||(i=Promise))((function(n,o){function s(t){try{h(r.next(t))}catch(t){o(t)}}function a(t){try{h(r.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}h((r=r.apply(t,e||[])).next())}))},A=function(t,e){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},I=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=t[i]&&function(e){return new Promise((function(r,n){(function(t,e,i,r){Promise.resolve(r).then((function(e){t({value:e,done:i})}),e)})(r,n,(e=t[i](e)).done,e.value)}))}}},T=function(t){return this instanceof T?(this.v=t,this):new T(t)},L=function(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=i.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){n[t]&&(r[t]=function(e){return new Promise((function(i,r){o.push([t,e,i,r])>1||a(t,e)}))})}function a(t,e){try{(i=n[t](e)).value instanceof T?Promise.resolve(i.value.v).then(h,c):f(o[0][2],i)}catch(t){f(o[0][3],t)}var i}function h(t){a("next",t)}function c(t){a("throw",t)}function f(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},C=new DataView(new ArrayBuffer(0)),z=new Uint8Array(C.buffer),k=function(){try{C.getInt8(0)}catch(t){return t.constructor}throw new Error("never reached")}(),D=new k("Insufficient data"),M=new E,_=function(){function e(t,e,i,r,n,o,s,a){void 0===t&&(t=U.defaultCodec),void 0===e&&(e=void 0),void 0===i&&(i=4294967295),void 0===r&&(r=4294967295),void 0===n&&(n=4294967295),void 0===o&&(o=4294967295),void 0===s&&(s=4294967295),void 0===a&&(a=M),this.extensionCodec=t,this.context=e,this.maxStrLength=i,this.maxBinLength=r,this.maxArrayLength=n,this.maxMapLength=o,this.maxExtLength=s,this.keyDecoder=a,this.totalPos=0,this.pos=0,this.view=C,this.bytes=z,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(t){this.bytes=b(t),this.view=function(t){if(t instanceof ArrayBuffer)return new DataView(t);var e=b(t);return new DataView(e.buffer,e.byteOffset,e.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(t){if(-1!==this.headByte||this.hasRemaining(1)){var e=this.bytes.subarray(this.pos),i=b(t),r=new Uint8Array(e.length+i.length);r.set(e),r.set(i,e.length),this.setBuffer(r)}else this.setBuffer(t)},e.prototype.hasRemaining=function(t){return this.view.byteLength-this.pos>=t},e.prototype.createExtraByteError=function(t){var e=this.view,i=this.pos;return new RangeError("Extra ".concat(e.byteLength-i," of ").concat(e.byteLength," byte(s) found at buffer[").concat(t,"]"))},e.prototype.decode=function(t){this.reinitializeState(),this.setBuffer(t);var e=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return e},e.prototype.decodeMulti=function(t){return A(this,(function(e){switch(e.label){case 0:this.reinitializeState(),this.setBuffer(t),e.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return e.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(t){var e,i,r,n;return B(this,void 0,void 0,(function(){var o,s,a,h,c,f,u,p;return A(this,(function(d){switch(d.label){case 0:o=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),e=I(t),d.label=2;case 2:return[4,e.next()];case 3:if((i=d.sent()).done)return[3,5];if(a=i.value,o)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{s=this.doDecodeSync(),o=!0}catch(t){if(!(t instanceof k))throw t}this.totalPos+=this.pos,d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return h=d.sent(),r={error:h},[3,12];case 7:return d.trys.push([7,,10,11]),i&&!i.done&&(n=e.return)?[4,n.call(e)]:[3,9];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(o){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,s]}throw f=(c=this).headByte,u=c.pos,p=c.totalPos,new RangeError("Insufficient data in parsing ".concat(S(f)," at ").concat(p," (").concat(u," in the current buffer)"))}}))}))},e.prototype.decodeArrayStream=function(t){return this.decodeMultiAsync(t,!0)},e.prototype.decodeStream=function(t){return this.decodeMultiAsync(t,!1)},e.prototype.decodeMultiAsync=function(t,e){return L(this,arguments,(function(){var i,r,n,o,s,a,h,c,f;return A(this,(function(u){switch(u.label){case 0:i=e,r=-1,u.label=1;case 1:u.trys.push([1,13,14,19]),n=I(t),u.label=2;case 2:return[4,T(n.next())];case 3:if((o=u.sent()).done)return[3,12];if(s=o.value,e&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),i&&(r=this.readArraySize(),i=!1,this.complete()),u.label=4;case 4:u.trys.push([4,9,,10]),u.label=5;case 5:return[4,T(this.doDecodeSync())];case 6:return[4,u.sent()];case 7:return u.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=u.sent())instanceof k))throw a;return[3,10];case 10:this.totalPos+=this.pos,u.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return h=u.sent(),c={error:h},[3,19];case 14:return u.trys.push([14,,17,18]),o&&!o.done&&(f=n.return)?[4,T(f.call(n))]:[3,16];case 15:u.sent(),u.label=16;case 16:return[3,18];case 17:if(c)throw c.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){t:for(;;){var e=this.readHeadByte(),i=void 0;if(e>=224)i=e-256;else if(e<192)if(e<128)i=e;else if(e<144){if(0!==(n=e-128)){this.pushMapState(n),this.complete();continue t}i={}}else if(e<160){if(0!==(n=e-144)){this.pushArrayState(n),this.complete();continue t}i=[]}else{var r=e-160;i=this.decodeUtf8String(r,0)}else if(192===e)i=null;else if(193===e)i=void 0;else if(194===e)i=!1;else if(195===e)i=!0;else if(202===e)i=this.readF32();else if(203===e)i=this.readF64();else if(204===e)i=this.readU8();else if(205===e)i=this.readU16();else if(206===e)i=this.readU32();else if(207===e)i=this.readU64();else if(208===e)i=this.readI8();else if(209===e)i=this.readI16();else if(210===e)i=this.readI32();else if(211===e)i=this.readI64();else if(217===e){r=this.lookU8();i=this.decodeUtf8String(r,1)}else if(218===e){r=this.lookU16();i=this.decodeUtf8String(r,2)}else if(219===e){r=this.lookU32();i=this.decodeUtf8String(r,4)}else if(220===e){if(0!==(n=this.readU16())){this.pushArrayState(n),this.complete();continue t}i=[]}else if(221===e){if(0!==(n=this.readU32())){this.pushArrayState(n),this.complete();continue t}i=[]}else if(222===e){if(0!==(n=this.readU16())){this.pushMapState(n),this.complete();continue t}i={}}else if(223===e){if(0!==(n=this.readU32())){this.pushMapState(n),this.complete();continue t}i={}}else if(196===e){var n=this.lookU8();i=this.decodeBinary(n,1)}else if(197===e){n=this.lookU16();i=this.decodeBinary(n,2)}else if(198===e){n=this.lookU32();i=this.decodeBinary(n,4)}else if(212===e)i=this.decodeExtension(1,0);else if(213===e)i=this.decodeExtension(2,0);else if(214===e)i=this.decodeExtension(4,0);else if(215===e)i=this.decodeExtension(8,0);else if(216===e)i=this.decodeExtension(16,0);else if(199===e){n=this.lookU8();i=this.decodeExtension(n,1)}else if(200===e){n=this.lookU16();i=this.decodeExtension(n,2)}else{if(201!==e)throw new v("Unrecognized type byte: ".concat(S(e)));n=this.lookU32();i=this.decodeExtension(n,4)}this.complete();for(var o=this.stack;o.length>0;){var s=o[o.length-1];if(0===s.type){if(s.array[s.position]=i,s.position++,s.position!==s.size)continue t;o.pop(),i=s.array}else{if(1===s.type){if(a=void 0,"string"!==(a=t(i))&&"number"!==a)throw new v("The type of key must be string or number but "+t(i));if("__proto__"===i)throw new v("The key __proto__ is not allowed");s.key=i,s.type=2;continue t}if(s.map[s.key]=i,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue t}o.pop(),i=s.map}}return i}var a},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:if(t<160)return t-144;throw new v("Unrecognized array type byte: ".concat(S(t)))}},e.prototype.pushMapState=function(t){if(t>this.maxMapLength)throw new v("Max length exceeded: map length (".concat(t,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:t,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(t){if(t>this.maxArrayLength)throw new v("Max length exceeded: array length (".concat(t,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:t,array:new Array(t),position:0})},e.prototype.decodeUtf8String=function(t,e){var i;if(t>this.maxStrLength)throw new v("Max length exceeded: UTF-8 byte length (".concat(t,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+e+t)throw D;var r,n=this.pos+e;return r=this.stateIsMapKey()&&(null===(i=this.keyDecoder)||void 0===i?void 0:i.canBeCached(t))?this.keyDecoder.decode(this.bytes,n,t):t>d?function(t,e,i){var r=t.subarray(e,e+i);return p.decode(r)}(this.bytes,n,t):u(this.bytes,n,t),this.pos+=e+t,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(t,e){if(t>this.maxBinLength)throw new v("Max length exceeded: bin length (".concat(t,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(t+e))throw D;var i=this.pos+e,r=this.bytes.subarray(i,i+t);return this.pos+=e+t,r},e.prototype.decodeExtension=function(t,e){if(t>this.maxExtLength)throw new v("Max length exceeded: ext length (".concat(t,") > maxExtLength (").concat(this.maxExtLength,")"));var i=this.view.getInt8(this.pos+e),r=this.decodeBinary(t,e+1);return this.extensionCodec.decode(r,i,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var t=this.view.getUint8(this.pos);return this.pos++,t},e.prototype.readI8=function(){var t=this.view.getInt8(this.pos);return this.pos++,t},e.prototype.readU16=function(){var t=this.view.getUint16(this.pos);return this.pos+=2,t},e.prototype.readI16=function(){var t=this.view.getInt16(this.pos);return this.pos+=2,t},e.prototype.readU32=function(){var t=this.view.getUint32(this.pos);return this.pos+=4,t},e.prototype.readI32=function(){var t=this.view.getInt32(this.pos);return this.pos+=4,t},e.prototype.readU64=function(){var t,e,i=(t=this.view,e=this.pos,4294967296*t.getUint32(e)+t.getUint32(e+4));return this.pos+=8,i},e.prototype.readI64=function(){var t=o(this.view,this.pos);return this.pos+=8,t},e.prototype.readF32=function(){var t=this.view.getFloat32(this.pos);return this.pos+=4,t},e.prototype.readF64=function(){var t=this.view.getFloat64(this.pos);return this.pos+=8,t},e}(),F={};var O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},P={exports:{}};function j(t,e){var i,r;return void 0===e&&(e={}),R(function(t,e){return void 0===e&&(e=x),new m(e.extensionCodec,e.context,e.maxDepth,e.initialBufferSize,e.sortKeys,e.forceFloat32,e.ignoreUndefined,e.forceIntegerToFloat).encodeSharedRef(t)}(t,{maxDepth:null!==(i=e.maxDepth)&&void 0!==i?i:10,sortKeys:null===(r=e.sortKeys)||void 0===r||r}))}function W(t){return e=K(t),void 0===i&&(i=F),new _(i.extensionCodec,i.context,i.maxStrLength,i.maxBinLength,i.maxArrayLength,i.maxMapLength,i.maxExtLength).decode(e);var e,i}!function(e,i){!function(r){var n=i,o=e&&e.exports==n&&e,s="object"==t(O)&&O;s.global!==s&&s.window!==s||(r=s);var a=function(t){this.message=t};(a.prototype=new Error).name="InvalidCharacterError";var h=function(t){throw new a(t)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=/[\t\n\f\r ]/g,u={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var e,i,r,n,o=t.length%3,s="",a=-1,f=t.length-o;++a<f;)e=t.charCodeAt(a)<<16,i=t.charCodeAt(++a)<<8,r=t.charCodeAt(++a),s+=c.charAt((n=e+i+r)>>18&63)+c.charAt(n>>12&63)+c.charAt(n>>6&63)+c.charAt(63&n);return 2==o?(e=t.charCodeAt(a)<<8,i=t.charCodeAt(++a),s+=c.charAt((n=e+i)>>10)+c.charAt(n>>4&63)+c.charAt(n<<2&63)+"="):1==o&&(n=t.charCodeAt(a),s+=c.charAt(n>>2)+c.charAt(n<<4&63)+"=="),s},decode:function(t){var e=(t=String(t).replace(f,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&h("Invalid character: the string to be decoded is not correctly encoded.");for(var i,r,n=0,o="",s=-1;++s<e;)r=c.indexOf(t.charAt(s)),i=n%4?64*i+r:r,n++%4&&(o+=String.fromCharCode(255&i>>(-2*n&6)));return o},version:"1.0.0"};if(n&&!n.nodeType)if(o)o.exports=u;else for(var p in u)u.hasOwnProperty(p)&&(n[p]=u[p]);else r.base64=u}(O)}(P,P.exports);var R=function(t){for(var e=[],i=0,r=t.length;i<r;i++)e.push(String.fromCharCode(t[i]));return P.exports.encode(e.join(""))},V=function(t){return t.charCodeAt(0)},K=function(t){return Uint8Array.from(P.exports.decode(t),V)};function N(t,e){return function(t){return"string"==typeof t&&t.startsWith("RUNE_MSG_V2;")}(t)&&function(t){return W(t.slice("RUNE_MSG_V2;".length))}(t)[e]||null}exports.getGameToClientMsg=function(t){return N(t,"runeGameEvent")},exports.stringifyClientToGameMsg=function(t){return e={runeGameCommand:t},"".concat("RUNE_MSG_V2;").concat(j(e));var e};
