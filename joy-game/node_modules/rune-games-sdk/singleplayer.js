/*
Copyright (c) 2022 Rune AI Inc.
All rights reserved.

This code is proprietary to Rune AI Inc.
The code may be used solely for accessing the Service provided by Rune AI Inc. following the Rune Terms of Service ("Terms") accessible at rune.ai/eula. You may not use this code for any use or purpose other than as expressly permitted by the Terms.
Restrictions set forth in the Terms include, but is not limited to, that you may not copy, adapt, modify, prepare derivative works based upon, distribute, license, sell, transfer, publicly display, publicly perform, transmit, stream, broadcast, attempt to discover any source code, reverse engineer, decompile, dissemble, or otherwise exploit the code as a whole or any portion of the code.
*/
var Rune=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}var e=function(){return e=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},e.apply(this,arguments)};function n(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var r,o,a=function(){return a=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},a.apply(this,arguments)};function s(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function h(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}!function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"}(r||(r={})),function(t){t.Parent="#_parent",t.Internal="#_internal"}(o||(o={}));var f=r.Start,l=r.Stop,d=r.Raise,p=r.Send,v=r.Cancel,y=r.NullEvent,g=r.Assign;r.After,r.DoneState;var m=r.Log,w=r.Init,b=r.Invoke;r.ErrorExecution;var S,x=r.ErrorPlatform,E=r.ErrorCustom,_=r.Update,U=r.Choose,A=r.Pure,I={},O="xstate.guard";function T(t,e,n){void 0===n&&(n=".");var i=L(t,n),r=L(e,n);return J(r)?!!J(i)&&r===i:J(i)?i in r:Object.keys(i).every((function(t){return t in r&&T(i[t],r[t])}))}function N(t){try{return J(t)||"number"==typeof t?"".concat(t):t.type}catch(t){throw new Error("Events must be strings or objects with a string event.type property.")}}function R(t,e){try{return H(t)?t:t.toString().split(e)}catch(e){throw new Error("'".concat(t,"' is not a valid state path."))}}function L(e,n){return"object"===t(i=e)&&"value"in i&&"context"in i&&"event"in i&&"_event"in i?e.value:H(e)?k(e):"string"!=typeof e?e:k(R(e,n));var i}function k(t){if(1===t.length)return t[0];for(var e={},n=e,i=0;i<t.length-1;i++)i===t.length-2?n[t[i]]=t[i+1]:(n[t[i]]={},n=n[t[i]]);return e}function M(t,e){for(var n={},i=Object.keys(t),r=0;r<i.length;r++){var o=i[r];n[o]=e(t[o],o,t,r)}return n}function P(t,e,n){var i,r,o={};try{for(var a=c(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,h=t[u];n(h)&&(o[u]=e(h,u,t))}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}var C=function(t){return function(e){var n,i,r=e;try{for(var o=c(t),a=o.next();!a.done;a=o.next()){r=r[a.value]}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return r}};function D(t){return t?J(t)?[[t]]:j(Object.keys(t).map((function(e){var n=t[e];return"string"==typeof n||n&&Object.keys(n).length?D(t[e]).map((function(t){return[e].concat(t)})):[[e]]}))):[[]]}function j(t){var e;return(e=[]).concat.apply(e,h([],u(t),!1))}function B(t){return H(t)?t:[t]}function G(t){return void 0===t?[]:B(t)}function z(t,e,n){var i,r;if(q(t))return t(e,n.data);var o={};try{for(var a=c(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,h=t[u];q(h)?o[u]=h(e,n.data):o[u]=h}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function V(e){return e instanceof Promise||!(null===e||!q(e)&&"object"!==t(e)||!q(e.then))}function F(t,e){var n,i,r=u([[],[]],2),o=r[0],a=r[1];try{for(var s=c(t),h=s.next();!h.done;h=s.next()){var f=h.value;e(f)?o.push(f):a.push(f)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return[o,a]}function W(t,e){return M(t.states,(function(t,n){if(t){var i=(J(e)?void 0:e[n])||(t?t.current:void 0);if(i)return{current:i,states:W(t,i)}}}))}function K(t,e,n,i){var r=t?n.reduce((function(t,n){var r,o,a=n.assignment,s={state:i,action:n,_event:e},u={};if(q(a))u=a(t,e.data,s);else try{for(var h=c(Object.keys(a)),f=h.next();!f.done;f=h.next()){var l=f.value,d=a[l];u[l]=q(d)?d(t,e.data,s):d}}catch(t){r={error:t}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}return Object.assign({},t,u)}),t):t;return r}function H(t){return Array.isArray(t)}function q(t){return"function"==typeof t}function J(t){return"string"==typeof t}function Y(t,e){if(t)return J(t)?{type:O,name:t,predicate:e?e[t]:void 0}:q(t)?{type:O,name:t.name,predicate:t}:t}var $=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function X(t){return!!t&&"__xstatenode"in t}function Z(t,e){return J(t)||"number"==typeof t?a({type:t},e):t}function Q(t,e){if(!J(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var n=Z(t);return a({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function tt(t,e){return B(e).map((function(e){return void 0===e||"string"==typeof e||X(e)?{target:e,event:t}:a(a({},e),{event:t})}))}function et(t,e,n,i,r){var o=t.options.guards,a={state:r,cond:e,_event:i};if(e.type===O)return((null==o?void 0:o[e.name])||e.predicate)(n,i.data,a);var s=null==o?void 0:o[e.type];if(!s)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return s(n,i.data,a)}function nt(t){return"string"==typeof t?{type:t}:t}function it(e,n,i){if("object"===t(e))return e;var r=function(){};return{next:e,error:n||r,complete:i||r}}function rt(t,e){return"".concat(t,":invocation[").concat(e,"]")}(S={})[$]=function(){return this},S[Symbol.observable]=function(){return this};var ot=Q({type:w});function at(t,e){return e&&e[t]||void 0}function st(t,e){var n;if(J(t)||"number"==typeof t)n=q(i=at(t,e))?{type:t,exec:i}:i||{type:t,exec:void 0};else if(q(t))n={type:t.name||t.toString(),exec:t};else{var i;if(q(i=at(t.type,e)))n=a(a({},t),{exec:i});else if(i){var r=i.type||t.type;n=a(a(a({},i),t),{type:r})}else n=t}return n}var ct=function(t,e){return t?(H(t)?t:[t]).map((function(t){return st(t,e)})):[]};function ut(t){var e=st(t);return a(a({id:J(t)?t:e.id},e),{type:e.type})}function ht(t){return J(t)?{type:d,event:t}:ft(t,{to:o.Internal})}function ft(t,e){return{to:e?e.to:void 0,type:p,event:q(t)?t:Z(t),delay:e?e.delay:void 0,id:e&&void 0!==e.id?e.id:q(t)?t.name:N(t)}}function lt(t,e){var n="".concat(r.DoneState,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function dt(t,e){var n="".concat(r.DoneInvoke,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function pt(t,e){var n="".concat(r.ErrorPlatform,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function vt(t,e,n,i,o,s){void 0===s&&(s=!1);var c=u(s?[[],o]:F(o,(function(t){return t.type===g})),2),f=c[0],v=c[1],y=f.length?K(n,i,f,e):n,w=s?[n]:void 0,b=j(v.map((function(n){var o;switch(n.type){case d:return{type:d,_event:Q(n.event)};case p:var c=function(t,e,n,i){var r,o={_event:n},s=Q(q(t.event)?t.event(e,n.data,o):t.event);if(J(t.delay)){var c=i&&i[t.delay];r=q(c)?c(e,n.data,o):c}else r=q(t.delay)?t.delay(e,n.data,o):t.delay;var u=q(t.to)?t.to(e,n.data,o):t.to;return a(a({},t),{to:u,_event:s,event:s.data,delay:r})}(n,y,i,t.options.delays);return c;case m:return function(t,e,n){return a(a({},t),{value:J(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})}(n,y,i);case U:if(!(S=null===(o=n.conds.find((function(n){var r=Y(n.cond,t.options.guards);return!r||et(t,r,y,i,e)})))||void 0===o?void 0:o.actions))return[];var f=u(vt(t,e,y,i,ct(G(S),t.options.actions),s),2),v=f[0],b=f[1];return y=b,null==w||w.push(y),v;case A:var S;if(!(S=n.get(y,i.data)))return[];var x=u(vt(t,e,y,i,ct(G(S),t.options.actions),s),2),E=x[0],_=x[1];return y=_,null==w||w.push(y),E;case l:return function(t,e,n){var i=q(t.activity)?t.activity(e,n.data):t.activity,o="string"==typeof i?{id:i}:i;return{type:r.Stop,activity:o}}(n,y,i);case g:y=K(y,i,[n],e),null==w||w.push(y);break;default:var I=st(n,t.options.actions),O=I.exec;if(O&&w){var T=w.length-1;I=a(a({},I),{exec:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];O.apply(void 0,h([w[T]],u(e),!1))}})}return I}})).filter((function(t){return!!t})));return[b,y]}var yt=function(t,e){return e(t)};function gt(t){var e;return(e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}})[$]=function(){return this},e}function mt(t,e,n,i){var r,o=nt(t.src),a=null===(r=null==e?void 0:e.options.services)||void 0===r?void 0:r[o.type],s=t.data?z(t.data,n,i):void 0,c=a?function(t,e,n){var i=gt(e);if(i.deferred=!0,X(t)){var r=i.state=yt(void 0,(function(){return(n?t.withContext(n):t).initialState}));i.getSnapshot=function(){return r}}return i}(a,t.id,s):gt(t.id);return c.meta=t,c}var wt=function(t){return"atomic"===t.type||"final"===t.type};function bt(t){return Object.keys(t.states).map((function(e){return t.states[e]})).filter((function(t){return"history"!==t.type}))}function St(t){var e=[t];return wt(t)?e:e.concat(j(bt(t).map(St)))}function xt(t,e){var n,i,r,o,a,s,u,h,f=_t(new Set(t)),l=new Set(e);try{for(var d=c(l),p=d.next();!p.done;p=d.next())for(var v=(_=p.value).parent;v&&!l.has(v);)l.add(v),v=v.parent}catch(t){n={error:t}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}var y=_t(l);try{for(var g=c(l),m=g.next();!m.done;m=g.next()){if("compound"!==(_=m.value).type||y.get(_)&&y.get(_).length){if("parallel"===_.type)try{for(var w=(a=void 0,c(bt(_))),b=w.next();!b.done;b=w.next()){var S=b.value;l.has(S)||(l.add(S),f.get(S)?f.get(S).forEach((function(t){return l.add(t)})):S.initialStateNodes.forEach((function(t){return l.add(t)})))}}catch(t){a={error:t}}finally{try{b&&!b.done&&(s=w.return)&&s.call(w)}finally{if(a)throw a.error}}}else f.get(_)?f.get(_).forEach((function(t){return l.add(t)})):_.initialStateNodes.forEach((function(t){return l.add(t)}))}}catch(t){r={error:t}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}try{for(var x=c(l),E=x.next();!E.done;E=x.next()){var _;for(v=(_=E.value).parent;v&&!l.has(v);)l.add(v),v=v.parent}}catch(t){u={error:t}}finally{try{E&&!E.done&&(h=x.return)&&h.call(x)}finally{if(u)throw u.error}}return l}function Et(t,e){var n=e.get(t);if(!n)return{};if("compound"===t.type){var i=n[0];if(!i)return{};if(wt(i))return i.key}var r={};return n.forEach((function(t){r[t.key]=Et(t,e)})),r}function _t(t){var e,n,i=new Map;try{for(var r=c(t),o=r.next();!o.done;o=r.next()){var a=o.value;i.has(a)||i.set(a,[]),a.parent&&(i.has(a.parent)||i.set(a.parent,[]),i.get(a.parent).push(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Ut(t,e){return Et(t,_t(xt([t],e)))}function At(t,e){return Array.isArray(t)?t.some((function(t){return t===e})):t instanceof Set&&t.has(e)}function It(t,e){return"compound"===e.type?bt(e).some((function(e){return"final"===e.type&&At(t,e)})):"parallel"===e.type&&bt(e).every((function(e){return It(t,e)}))}function Ot(t){return new Set(j(t.map((function(t){return t.tags}))))}function Tt(t,e){if(t===e)return!0;if(void 0===t||void 0===e)return!1;if(J(t)||J(e))return t===e;var n=Object.keys(t),i=Object.keys(e);return n.length===i.length&&n.every((function(n){return Tt(t[n],e[n])}))}var Nt=function(){function t(t){var e,n,i=this;this.actions=[],this.activities=I,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||I,this.meta=(void 0===(n=t.configuration)&&(n=[]),n.reduce((function(t,e){return void 0!==e.meta&&(t[e.id]=e.meta),t}),{})),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=null!==(e=Array.isArray(t.tags)?new Set(t.tags):t.tags)&&void 0!==e?e:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(t){return h([],u(new Set(j(h([],u(t.map((function(t){return t.ownEvents}))),!1)))),!1)}(i.configuration)}})}return t.from=function(e,n){return e instanceof t?e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e:new t({value:e,context:n,_event:ot,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var i=ot;return new t({value:e.value,context:n,_event:i,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(t,e){var n=this;if(void 0===t&&(t=this.value),void 0===e&&(e="."),J(t))return[t];var i=Object.keys(t);return i.concat.apply(i,h([],u(i.map((function(i){return n.toStrings(t[i],e).map((function(t){return i+e+t}))}))),!1))},t.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var e=t.tags;t.machine;var n=s(t,["configuration","transitions","tags","machine"]);return a(a({},n),{tags:Array.from(e)})},t.prototype.matches=function(t){return T(t,this.value)},t.prototype.hasTag=function(t){return this.tags.has(t)},t.prototype.can=function(t){var e;this.machine;var n=null===(e=this.machine)||void 0===e?void 0:e.getTransitionData(this,t);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},t}(),Rt={deferEvents:!1},Lt=function(){function t(t){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=a(a({},Rt),t)}return t.prototype.initialize=function(t){if(this.initialized=!0,t){if(!this.options.deferEvents)return void this.schedule(t);this.process(t)}this.flushEvents()},t.prototype.schedule=function(t){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(t),this.flushEvents()}else this.queue.push(t)},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var t=this.queue.shift();t;)this.process(t),t=this.queue.shift()},t.prototype.process=function(t){this.processingEvent=!0;try{t()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},t}(),kt=new Map,Mt=0,Pt=function(){return"x:".concat(Mt++)},Ct=function(t,e){return kt.set(t,e),t},Dt=function(t){return kt.get(t)},jt=function(t){kt.delete(t)};function Bt(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function Gt(t){if(Bt()){var e=function(){var t=Bt();if(t&&"__xstate__"in t)return t.__xstate__}();e&&e.register(t)}}function zt(t,e){void 0===e&&(e={});var n=t.initialState,i=new Set,r=[],o=!1,s=function(t){var e;return a(((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[$]=function(){return this},e),t)}({id:e.id,send:function(e){r.push(e),function(){if(!o){for(o=!0;r.length>0;){var e=r.shift();n=t.transition(n,e,c),i.forEach((function(t){return t.next(n)}))}o=!1}}()},getSnapshot:function(){return n},subscribe:function(t,e,r){var o=it(t,e,r);return i.add(o),o.next(n),{unsubscribe:function(){i.delete(o)}}}}),c={parent:e.parent,self:s,id:e.id||"anonymous",observers:i};return n=t.start?t.start(c):n,s}var Vt,Ft={sync:!1,autoForward:!1};!function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(Vt||(Vt={}));var Wt=function(){function e(t,n){var i=this;void 0===n&&(n=e.defaultOptions),this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Vt.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(t,e){if(H(t))return i.batch(t),i.state;var n=Q(Z(t,e));if(i.status===Vt.Stopped)return i.state;if(i.status!==Vt.Running&&!i.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(i.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return i.scheduler.schedule((function(){i.forward(n);var t=i.nextState(n);i.update(t,n)})),i._state},this.sendTo=function(t,e){var n,r=i.parent&&(e===o.Parent||i.parent.id===e),s=r?i.parent:J(e)?i.children.get(e)||Dt(e):(n=e)&&"function"==typeof n.send?e:void 0;if(s)"machine"in s?s.send(a(a({},t),{name:t.name===E?"".concat(pt(i.id)):t.name,origin:i.sessionId})):s.send(t.data);else if(!r)throw new Error("Unable to send event to child '".concat(e,"' from service '").concat(i.id,"'."))};var r=a(a({},e.defaultOptions),n),s=r.clock,c=r.logger,u=r.parent,h=r.id,f=void 0!==h?h:t.id;this.id=f,this.logger=c,this.clock=s,this.parent=u,this.options=r,this.scheduler=new Lt({deferEvents:this.options.deferEvents}),this.sessionId=Pt()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var t=this;return this._initialState?this._initialState:yt(this,(function(){return t._initialState=t.machine.initialState,t._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(t,e){var n,i;try{for(var r=c(t.actions),o=r.next();!o.done;o=r.next()){var a=o.value;this.exec(a,t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}},e.prototype.update=function(t,e){var n,i,r,o,a,s,u,h,f=this;if(t._sessionid=this.sessionId,this._state=t,this.options.execute&&this.execute(this.state),this.children.forEach((function(t){f.state.children[t.id]=t})),this.devTools&&this.devTools.send(e.data,t),t.event)try{for(var l=c(this.eventListeners),d=l.next();!d.done;d=l.next()){(0,d.value)(t.event)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}try{for(var p=c(this.listeners),v=p.next();!v.done;v=p.next()){(0,v.value)(t,t.event)}}catch(t){r={error:t}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}try{for(var y=c(this.contextListeners),g=y.next();!g.done;g=y.next()){(0,g.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(t){a={error:t}}finally{try{g&&!g.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}var m=It(t.configuration||[],this.machine);if(this.state.configuration&&m){var w=t.configuration.find((function(t){return"final"===t.type&&t.parent===f.machine})),b=w&&w.doneData?z(w.doneData,t.context,e):void 0;try{for(var S=c(this.doneListeners),x=S.next();!x.done;x=S.next()){(0,x.value)(dt(this.id,b))}}catch(t){u={error:t}}finally{try{x&&!x.done&&(h=S.return)&&h.call(S)}finally{if(u)throw u.error}}this.stop()}},e.prototype.onTransition=function(t){return this.listeners.add(t),this.status===Vt.Running&&t(this.state,this.state.event),this},e.prototype.subscribe=function(t,e,n){var i,r=this;if(!t)return{unsubscribe:function(){}};var o=n;return"function"==typeof t?i=t:(i=t.next.bind(t),o=t.complete.bind(t)),this.listeners.add(i),this.status!==Vt.NotStarted&&i(this.state),o&&(this.status===Vt.Stopped?o():this.onDone(o)),{unsubscribe:function(){i&&r.listeners.delete(i),o&&r.doneListeners.delete(o)}}},e.prototype.onEvent=function(t){return this.eventListeners.add(t),this},e.prototype.onSend=function(t){return this.sendListeners.add(t),this},e.prototype.onChange=function(t){return this.contextListeners.add(t),this},e.prototype.onStop=function(t){return this.stopListeners.add(t),this},e.prototype.onDone=function(t){return this.doneListeners.add(t),this},e.prototype.off=function(t){return this.listeners.delete(t),this.eventListeners.delete(t),this.sendListeners.delete(t),this.stopListeners.delete(t),this.doneListeners.delete(t),this.contextListeners.delete(t),this},e.prototype.start=function(e){var n=this;if(this.status===Vt.Running)return this;this.machine._init(),Ct(this.sessionId,this),this.initialized=!0,this.status=Vt.Running;var i=void 0===e?this.initialState:yt(this,(function(){return"object"===t(i=e)&&null!==i&&"value"in i&&"_event"in i?n.machine.resolveState(e):n.machine.resolveState(Nt.from(e,n.machine.context));var i}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){n.update(i,ot)})),this},e.prototype.stop=function(){var t,e,n,i,r,o,a,s,f,l,d=this;try{for(var p=c(this.listeners),v=p.next();!v.done;v=p.next()){var y=v.value;this.listeners.delete(y)}}catch(e){t={error:e}}finally{try{v&&!v.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}try{for(var g=c(this.stopListeners),m=g.next();!m.done;m=g.next()){(y=m.value)(),this.stopListeners.delete(y)}}catch(t){n={error:t}}finally{try{m&&!m.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}try{for(var w=c(this.contextListeners),b=w.next();!b.done;b=w.next()){y=b.value;this.contextListeners.delete(y)}}catch(t){r={error:t}}finally{try{b&&!b.done&&(o=w.return)&&o.call(w)}finally{if(r)throw r.error}}try{for(var S=c(this.doneListeners),x=S.next();!x.done;x=S.next()){y=x.value;this.doneListeners.delete(y)}}catch(t){a={error:t}}finally{try{x&&!x.done&&(s=S.return)&&s.call(S)}finally{if(a)throw a.error}}if(!this.initialized)return this;h([],u(this.state.configuration),!1).sort((function(t,e){return e.order-t.order})).forEach((function(t){var e,n;try{for(var i=c(t.definition.exit),r=i.next();!r.done;r=i.next()){var o=r.value;d.exec(o,d.state)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}})),this.children.forEach((function(t){q(t.stop)&&t.stop()})),this.children.clear();try{for(var E=c(Object.keys(this.delayedEventsMap)),_=E.next();!_.done;_=E.next()){var U=_.value;this.clock.clearTimeout(this.delayedEventsMap[U])}}catch(t){f={error:t}}finally{try{_&&!_.done&&(l=E.return)&&l.call(E)}finally{if(f)throw f.error}}return this.scheduler.clear(),this.scheduler=new Lt({deferEvents:this.options.deferEvents}),this.initialized=!1,this.status=Vt.Stopped,this._initialState=void 0,jt(this.sessionId),this},e.prototype.batch=function(t){var e=this;if(this.status===Vt.NotStarted&&this.options.deferEvents)0;else if(this.status!==Vt.Running)throw new Error("".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,i,r=e.state,o=!1,s=[],f=function(t){var n=Q(t);e.forward(n),r=yt(e,(function(){return e.machine.transition(r,n)})),s.push.apply(s,h([],u(r.actions.map((function(t){return n=r,i=(e=t).exec,a(a({},e),{exec:void 0!==i?function(){return i(n.context,n.event,{action:e,state:n,_event:n._event})}:void 0});var e,n,i}))),!1)),o=o||!!r.changed};try{for(var l=c(t),d=l.next();!d.done;d=l.next()){f(d.value)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}r.changed=o,r.actions=s,e.update(r,Q(t[t.length-1]))}))},e.prototype.sender=function(t){return this.send.bind(this,t)},e.prototype.nextState=function(t){var e=this,n=Q(t);if(0===n.name.indexOf(x)&&!this.state.nextEvents.some((function(t){return 0===t.indexOf(x)})))throw n.data.data;return yt(this,(function(){return e.machine.transition(e.state,n)}))},e.prototype.forward=function(t){var e,n;try{for(var i=c(this.forwardTo),r=i.next();!r.done;r=i.next()){var o=r.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(t,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(t)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.defer=function(t){var e=this;this.delayedEventsMap[t.id]=this.clock.setTimeout((function(){t.to?e.sendTo(t._event,t.to):e.send(t._event)}),t.delay)},e.prototype.cancel=function(t){this.clock.clearTimeout(this.delayedEventsMap[t]),delete this.delayedEventsMap[t]},e.prototype.exec=function(t,e,n){void 0===n&&(n=this.machine.options.actions);var i=e.context,o=e._event,a=t.exec||at(t.type,n),s=q(a)?a:a?a.exec:t.exec;if(s)try{return s(i,o.data,{action:t,state:this.state,_event:o})}catch(t){throw this.parent&&this.parent.send({type:"xstate.error",data:t}),t}switch(t.type){case p:var c=t;if("number"==typeof c.delay)return void this.defer(c);c.to?this.sendTo(c._event,c.to):this.send(c._event);break;case v:this.cancel(t.sendId);break;case f:if(this.status!==Vt.Running)return;var u=t.activity;if(!this.state.activities[u.id||u.type])break;if(u.type===r.Invoke){var h=nt(u.src),d=this.machine.options.services?this.machine.options.services[h.type]:void 0,y=u.id,g=u.data;0;var w="autoForward"in u?u.autoForward:!!u.forward;if(!d)return void 0;var b=g?z(g,i,o):void 0;if("string"==typeof d)return;var S=q(d)?d(i,o.data,{data:b,src:h,meta:u.meta}):d;if(!S)return;var x=void 0;X(S)&&(S=b?S.withContext(b):S,x={autoForward:w}),this.spawn(S,y,x)}else this.spawnActivity(u);break;case l:this.stopChild(t.activity.id);break;case m:var E=t.label,_=t.value;E?this.logger(E,_):this.logger(_)}},e.prototype.removeChild=function(t){var e;this.children.delete(t),this.forwardTo.delete(t),null===(e=this.state)||void 0===e||delete e.children[t]},e.prototype.stopChild=function(t){var e=this.children.get(t);e&&(this.removeChild(t),q(e.stop)&&e.stop())},e.prototype.spawn=function(e,n,i){if(V(e))return this.spawnPromise(Promise.resolve(e),n);if(q(e))return this.spawnCallback(e,n);if(function(t){try{return"function"==typeof t.send}catch(t){return!1}}(o=e)&&"id"in o)return this.spawnActor(e,n);if(function(t){try{return"subscribe"in t&&q(t.subscribe)}catch(t){return!1}}(e))return this.spawnObservable(e,n);if(X(e))return this.spawnMachine(e,a(a({},i),{id:n}));if(null!==(r=e)&&"object"===t(r)&&"transition"in r&&"function"==typeof r.transition)return this.spawnBehavior(e,n);throw new Error('Unable to spawn entity "'.concat(n,'" of type "').concat(t(e),'".'));var r,o},e.prototype.spawnMachine=function(t,n){var i=this;void 0===n&&(n={});var r=new e(t,a(a({},this.options),{parent:this,id:n.id||t.id})),o=a(a({},Ft),n);o.sync&&r.onTransition((function(t){i.send(_,{state:t,id:r.id})}));var s=r;return this.children.set(r.id,s),o.autoForward&&this.forwardTo.add(r.id),r.onDone((function(t){i.removeChild(r.id),i.send(Q(t,{origin:r.id}))})).start(),s},e.prototype.spawnBehavior=function(t,e){var n=zt(t,{id:e,parent:this});return this.children.set(e,n),n},e.prototype.spawnPromise=function(t,e){var n,i,r=this,o=!1;t.then((function(t){o||(i=t,r.removeChild(e),r.send(Q(dt(e,t),{origin:e})))}),(function(t){if(!o){r.removeChild(e);var n=pt(e,t);try{r.send(Q(n,{origin:e}))}catch(t){r.devTools&&r.devTools.send(n,r.state),r.machine.strict&&r.stop()}}}));var a=((n={id:e,send:function(){},subscribe:function(e,n,i){var r=it(e,n,i),o=!1;return t.then((function(t){o||(r.next(t),o||r.complete())}),(function(t){o||r.error(t)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:e}},getSnapshot:function(){return i}})[$]=function(){return this},n);return this.children.set(e,a),a},e.prototype.spawnCallback=function(t,e){var n,i,r,o=this,a=!1,s=new Set,c=new Set;try{r=t((function(t){i=t,c.forEach((function(e){return e(t)})),a||o.send(Q(t,{origin:e}))}),(function(t){s.add(t)}))}catch(t){this.send(pt(e,t))}if(V(r))return this.spawnPromise(r,e);var u=((n={id:e,send:function(t){return s.forEach((function(e){return e(t)}))},subscribe:function(t){var e=it(t);return c.add(e.next),{unsubscribe:function(){c.delete(e.next)}}},stop:function(){a=!0,q(r)&&r()},toJSON:function(){return{id:e}},getSnapshot:function(){return i}})[$]=function(){return this},n);return this.children.set(e,u),u},e.prototype.spawnObservable=function(t,e){var n,i,r=this,o=t.subscribe((function(t){i=t,r.send(Q(t,{origin:e}))}),(function(t){r.removeChild(e),r.send(Q(pt(e,t),{origin:e}))}),(function(){r.removeChild(e),r.send(Q(dt(e),{origin:e}))})),a=((n={id:e,send:function(){},subscribe:function(e,n,i){return t.subscribe(e,n,i)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return i},toJSON:function(){return{id:e}}})[$]=function(){return this},n);return this.children.set(e,a),a},e.prototype.spawnActor=function(t,e){return this.children.set(e,t),t},e.prototype.spawnActivity=function(t){var e=this.machine.options&&this.machine.options.activities?this.machine.options.activities[t.type]:void 0;if(e){var n=e(this.state.context,t);this.spawnEffect(t.id,n)}},e.prototype.spawnEffect=function(t,e){var n;this.children.set(t,((n={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:e||void 0,getSnapshot:function(){},toJSON:function(){return{id:t}}})[$]=function(){return this},n))},e.prototype.attachDev=function(){var e=Bt();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var n="object"===t(this.options.devTools)?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(a(a({name:this.id,autoPause:!0,stateSanitizer:function(t){return{value:t.value,context:t.context,actions:t.actions}}},n),{features:a({jump:!1,skip:!1},n?n.features:void 0)}),this.machine),this.devTools.init(this.state)}Gt(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[$]=function(){return this},e.prototype.getSnapshot=function(){return this.status===Vt.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return setTimeout(t,e)})),clearTimeout:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return clearTimeout(t)}))},logger:console.log.bind(console),devTools:!1},e.interpret=Kt,e}();function Kt(t,e){return new Wt(t,e)}function Ht(t){if("string"==typeof t){var e={type:t,toString:function(){return t}};return e}return t}function qt(t){return a(a({type:b},t),{toJSON:function(){t.onDone,t.onError;var e=s(t,["onDone","onError"]);return a(a({},e),{type:b,src:Ht(t.src)})}})}var Jt="",Yt="*",$t={},Xt=function(t){return"#"===t[0]},Zt=function(){function e(t,n,i,r){var o,s=this;void 0===i&&(i="context"in t?t.context:void 0),this.config=t,this._context=i,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=null==r?void 0:r.parent,this.key=this.config.key||(null==r?void 0:r.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||h([this.machine.key],u(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?M(this.config.states,(function(t,n){var i,r=new e(t,{},void 0,{parent:s,key:n});return Object.assign(s.idMap,a(((i={})[r.id]=r,i),r.idMap)),r})):$t;var f=0;!function t(e){var n,i;e.order=f++;try{for(var r=c(bt(e)),o=r.next();!o.done;o=r.next()){t(o.value)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(t){return t.event===Jt})):Jt in this.config.on),this.strict=!!this.config.strict,this.onEntry=G(this.config.entry||this.config.onEntry).map((function(t){return st(t)})),this.onExit=G(this.config.exit||this.config.onExit).map((function(t){return st(t)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=G(this.config.invoke).map((function(t,e){var n,i;if(X(t)){var r=rt(s.id,e);return s.machine.options.services=a(((n={})[r]=t,n),s.machine.options.services),qt({src:r,id:r})}if(J(t.src)){r=t.id||rt(s.id,e);return qt(a(a({},t),{id:r,src:t.src}))}if(X(t.src)||q(t.src)){r=t.id||rt(s.id,e);return s.machine.options.services=a(((i={})[r]=t.src,i),s.machine.options.services),qt(a(a({id:r},t),{src:r}))}var o=t.src;return qt(a(a({id:rt(s.id,e)},t),{src:o}))})),this.activities=G(this.config.activities).concat(this.invoke).map((function(t){return ut(t)})),this.transition=this.transition.bind(this),this.tags=G(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||St(this).forEach((function(t){return t.on}))},e.prototype.withConfig=function(t,n){var i=this.options,r=i.actions,o=i.activities,s=i.guards,c=i.services,u=i.delays;return new e(this.config,{actions:a(a({},r),t.actions),activities:a(a({},o),t.activities),guards:a(a({},s),t.guards),services:a(a({},c),t.services),delays:a(a({},u),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return q(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:M(this.states,(function(t){return t.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce((function(t,e){return t[e.eventType]=t[e.eventType]||[],t[e.eventType].push(e),t}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var e=t===Jt,n=this.transitions.filter((function(n){var i=n.eventType===t;return e?i:i||n.eventType===Yt}));return this.__cache.candidates[t]=n,n},e.prototype.getDelayedTransitions=function(){var t=this,e=this.config.after;if(!e)return[];var n=function(e,n){var i=function(t,e){var n=e?"#".concat(e):"";return"".concat(r.After,"(").concat(t,")").concat(n)}(q(e)?"".concat(t.id,":delay[").concat(n,"]"):e,t.id);return t.onEntry.push(ft(i,{delay:e})),t.onExit.push({type:v,sendId:i}),i};return(H(e)?e.map((function(t,e){var i=n(t.delay,e);return a(a({},t),{event:i})})):j(Object.keys(e).map((function(t,i){var r=e[t],o=J(r)?{target:r}:r,s=isNaN(+t)?t:+t,c=n(s,i);return G(o).map((function(t){return a(a({},t),{event:c,delay:s})}))})))).map((function(e){var n=e.delay;return a(a({},t.formatTransition(e)),{delay:n})}))},e.prototype.getStateNodes=function(t){var e,n=this;if(!t)return[];var i=t instanceof Nt?t.value:L(t,this.delimiter);if(J(i)){var r=this.getStateNode(i).initial;return void 0!==r?this.getStateNodes(((e={})[i]=r,e)):[this,this.states[i]]}var o=Object.keys(i),a=[this];return a.push.apply(a,h([],u(j(o.map((function(t){return n.getStateNode(t).getStateNodes(i[t])})))),!1)),a},e.prototype.handles=function(t){var e=N(t);return this.events.includes(e)},e.prototype.resolveState=function(t){var e=t instanceof Nt?t:Nt.create(t),n=Array.from(xt([],this.getStateNodes(e.value)));return new Nt(a(a({},e),{value:this.resolve(e.value),configuration:n,done:It(n,this),tags:Ot(n),machine:this.machine}))},e.prototype.transitionLeafNode=function(t,e,n){var i=this.getStateNode(t).next(e,n);return i&&i.transitions.length?i:this.next(e,n)},e.prototype.transitionCompoundNode=function(t,e,n){var i=Object.keys(t),r=this.getStateNode(i[0])._transition(t[i[0]],e,n);return r&&r.transitions.length?r:this.next(e,n)},e.prototype.transitionParallelNode=function(t,e,n){var i,r,o={};try{for(var a=c(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,h=t[u];if(h){var f=this.getStateNode(u)._transition(h,e,n);f&&(o[u]=f)}}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}var l=Object.keys(o).map((function(t){return o[t]})),d=j(l.map((function(t){return t.transitions})));if(!l.some((function(t){return t.transitions.length>0})))return this.next(e,n);var p=j(l.map((function(t){return t.entrySet}))),v=j(Object.keys(o).map((function(t){return o[t].configuration})));return{transitions:d,entrySet:p,exitSet:j(l.map((function(t){return t.exitSet}))),configuration:v,source:e,actions:j(Object.keys(o).map((function(t){return o[t].actions})))}},e.prototype._transition=function(t,e,n){return J(t)?this.transitionLeafNode(t,e,n):1===Object.keys(t).length?this.transitionCompoundNode(t,e,n):this.transitionParallelNode(t,e,n)},e.prototype.getTransitionData=function(t,e){return this._transition(t.value,t,Q(e))},e.prototype.next=function(t,e){var n,i,r,o=this,a=e.name,s=[],f=[];try{for(var l=c(this.getCandidates(a)),d=l.next();!d.done;d=l.next()){var p=d.value,v=p.cond,y=p.in,g=t.context,m=!y||(J(y)&&Xt(y)?t.matches(L(this.getStateNodeById(y).path,this.delimiter)):T(L(y,this.delimiter),C(this.path.slice(0,-2))(t.value))),w=!1;try{w=!v||et(this.machine,v,g,e,t)}catch(t){throw new Error("Unable to evaluate guard '".concat(v.name||v.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(t.message))}if(w&&m){void 0!==p.target&&(f=p.target),s.push.apply(s,h([],u(p.actions),!1)),r=p;break}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(r){if(!f.length)return{transitions:[r],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:s};var b=j(f.map((function(e){return o.getRelativeStateNodes(e,t.historyValue)}))),S=!!r.internal;return{transitions:[r],entrySet:S?[]:j(b.map((function(t){return o.nodesFromChild(t)}))),exitSet:S?[]:[this],configuration:b,source:t,actions:s}}},e.prototype.nodesFromChild=function(t){if(t.escapes(this))return[];for(var e=[],n=t;n&&n!==this;)e.push(n),n=n.parent;return e.push(this),e},e.prototype.escapes=function(t){if(this===t)return!1;for(var e=this.parent;e;){if(e===t)return!1;e=e.parent}return!0},e.prototype.getActions=function(t,e,n,i){var o,a,s,f,l=xt([],i?this.getStateNodes(i.value):[this]),d=t.configuration.length?xt(l,t.configuration):l;try{for(var p=c(d),v=p.next();!v.done;v=p.next()){At(l,m=v.value)||t.entrySet.push(m)}}catch(t){o={error:t}}finally{try{v&&!v.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}try{for(var y=c(l),g=y.next();!g.done;g=y.next()){var m;At(d,m=g.value)&&!At(t.exitSet,m.parent)||t.exitSet.push(m)}}catch(t){s={error:t}}finally{try{g&&!g.done&&(f=y.return)&&f.call(y)}finally{if(s)throw s.error}}var w=j(t.entrySet.map((function(i){var r=[];if("final"!==i.type)return r;var o=i.parent;if(!o.parent)return r;r.push(lt(i.id,i.doneData),lt(o.id,i.doneData?z(i.doneData,e,n):void 0));var a=o.parent;return"parallel"===a.type&&bt(a).every((function(e){return It(t.configuration,e)}))&&r.push(lt(a.id)),r})));t.exitSet.sort((function(t,e){return e.order-t.order})),t.entrySet.sort((function(t,e){return t.order-e.order}));var b=new Set(t.entrySet),S=new Set(t.exitSet),x=u([j(Array.from(b).map((function(t){return h(h([],u(t.activities.map((function(t){return function(t){var e=ut(t);return{type:r.Start,activity:e,exec:void 0}}(t)}))),!1),u(t.onEntry),!1)}))).concat(w.map(ht)),j(Array.from(S).map((function(t){return h(h([],u(t.onExit),!1),u(t.activities.map((function(t){return function(t){var e=q(t)?t:ut(t);return{type:r.Stop,activity:e,exec:void 0}}(t)}))),!1)})))],2),E=x[0],_=x[1];return ct(_.concat(t.actions).concat(E),this.machine.options.actions)},e.prototype.transition=function(t,e,n){void 0===t&&(t=this.initialState);var i,r,o=Q(e);if(t instanceof Nt)i=void 0===n?t:this.resolveState(Nt.from(t,n));else{var a=J(t)?this.resolve(k(this.getResolvedPath(t))):this.resolve(t),s=null!=n?n:this.machine.context;i=this.resolveState(Nt.from(a,s))}if(this.strict&&!this.events.includes(o.name)&&(r=o.name,!/^(done|error)\./.test(r)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var c=this._transition(i.value,i,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},f=xt([],this.getStateNodes(i.value)),l=c.configuration.length?xt(f,c.configuration):f;return c.configuration=h([],u(l),!1),this.resolveTransition(c,i,i.context,o)},e.prototype.resolveRaisedTransition=function(t,e,n){var i,r=t.actions;return(t=this.transition(t,e))._event=n,t.event=n.data,(i=t.actions).unshift.apply(i,h([],u(r),!1)),t},e.prototype.resolveTransition=function(e,n,i,r){var s,h,v=this;void 0===r&&(r=ot);var g=e.configuration,m=!n||e.transitions.length>0,w=m?Ut(this.machine,g):void 0,S=n?n.historyValue?n.historyValue:e.source?this.machine.historyValue(n.value):void 0:void 0,x=this.getActions(e,i,r,n),E=n?a({},n.activities):{};try{for(var U=c(x),A=U.next();!A.done;A=U.next()){var I=A.value;I.type===f?E[I.activity.id||I.activity.type]=I:I.type===l&&(E[I.activity.id||I.activity.type]=!1)}}catch(t){s={error:t}}finally{try{A&&!A.done&&(h=U.return)&&h.call(U)}finally{if(s)throw s.error}}var O,T,N=u(vt(this,n,i,r,x,this.machine.config.preserveActionOrder),2),R=N[0],L=N[1],k=u(F(R,(function(t){return t.type===d||t.type===p&&t.to===o.Internal})),2),M=k[0],P=k[1],C=R.filter((function(t){var e;return t.type===f&&(null===(e=t.activity)||void 0===e?void 0:e.type)===b})),D=C.reduce((function(t,e){return t[e.activity.id]=mt(e.activity,v.machine,L,r),t}),n?a({},n.children):{}),j=m?e.configuration:n?n.configuration:[],B=It(j,this),G=new Nt({value:w||n.value,context:L,_event:r,_sessionid:n?n._sessionid:null,historyValue:w?S?(O=S,T=w,{current:T,states:W(O,T)}):void 0:n?n.historyValue:void 0,history:!w||e.source?n:void 0,actions:w?P:[],activities:w?E:n?n.activities:{},events:[],configuration:j,transitions:e.transitions,children:D,done:B,tags:Ot(j),machine:this}),z=i!==L;G.changed=r.name===_||z;var V=G.history;V&&delete V.history;var K=!B&&(this._transient||g.some((function(t){return t._transient})));if(!(m||K&&r.name!==Jt))return G;var H=G;if(!B)for(K&&(H=this.resolveRaisedTransition(H,{type:y},r));M.length;){var q=M.shift();H=this.resolveRaisedTransition(H,q._event,r)}var J=H.changed||(V?!!H.actions.length||z||t(V.value)!==t(H.value)||!Tt(H.value,V.value):void 0);return H.changed=J,H.history=V,H},e.prototype.getStateNode=function(t){if(Xt(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var e=this.states[t];if(!e)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return e},e.prototype.getStateNodeById=function(t){var e=Xt(t)?t.slice("#".length):t;if(e===this.id)return this;var n=this.machine.idMap[e];if(!n)throw new Error("Child state node '#".concat(e,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(t){if("string"==typeof t&&Xt(t))try{return this.getStateNodeById(t.slice(1))}catch(t){}for(var e=R(t,this.delimiter).slice(),n=this;e.length;){var i=e.shift();if(!i.length)break;n=n.getStateNode(i)}return n},e.prototype.resolve=function(t){var e,n=this;if(!t)return this.initialStateValue||$t;switch(this.type){case"parallel":return M(this.initialStateValue,(function(e,i){return e?n.getStateNode(i).resolve(t[i]||e):$t}));case"compound":if(J(t)){var i=this.getStateNode(t);return"parallel"===i.type||"compound"===i.type?((e={})[t]=i.initialStateValue,e):t}return Object.keys(t).length?M(t,(function(t,e){return t?n.getStateNode(e).resolve(t):$t})):this.initialStateValue||{};default:return t||$t}},e.prototype.getResolvedPath=function(t){if(Xt(t)){var e=this.machine.idMap[t.slice("#".length)];if(!e)throw new Error("Unable to find state node '".concat(t,"'"));return e.path}return R(t,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var t,e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)e=P(this.states,(function(t){return t.initialStateValue||$t}),(function(t){return!("history"===t.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));e=wt(this.states[this.initial])?this.initial:((t={})[this.initial]=this.states[this.initial].initialStateValue,t)}else e={};return this.__cache.initialStateValue=e,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(t,e){this._init();var n=this.getStateNodes(t);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=e?e:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var t;if("history"===this.type){var e=this.config;t=J(e.target)&&Xt(e.target)?k(this.machine.getStateNodeById(e.target).path.slice(this.path.length-1)):e.target}return t},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(t,e,n){return void 0===n&&(n=!0),n?"history"===t.type?t.resolveHistory(e):t.initialStateNodes:[t]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var t=this;return wt(this)?[this]:"compound"!==this.type||this.initial?j(D(this.initialStateValue).map((function(e){return t.getFromRelativePath(e)}))):[this]},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var e=u(t),n=e[0],i=e.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var r=this.getStateNode(n);if("history"===r.type)return r.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},e.prototype.historyValue=function(t){if(Object.keys(this.states).length)return{current:t||this.initialStateValue,states:P(this.states,(function(e,n){if(!t)return e.historyValue();var i=J(t)?void 0:t[n];return e.historyValue(i||e.initialStateValue)}),(function(t){return!t.history}))}},e.prototype.resolveHistory=function(t){var e=this;if("history"!==this.type)return[this];var n=this.parent;if(!t){var i=this.target;return i?j(D(i).map((function(t){return n.getFromRelativePath(t)}))):n.initialStateNodes}var r,o,a=(r=n.path,o="states",function(t){var e,n,i=t;try{for(var a=c(r),s=a.next();!s.done;s=a.next()){var u=s.value;i=i[o][u]}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i})(t).current;return J(a)?[n.getStateNode(a)]:j(D(a).map((function(t){return"deep"===e.history?n.getFromRelativePath(t):[n.states[t[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var t=this,e=j(Object.keys(this.states).map((function(e){return t.states[e].stateIds})));return[this.id].concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var t,e,n,i;if(this.__cache.events)return this.__cache.events;var r=this.states,o=new Set(this.ownEvents);if(r)try{for(var a=c(Object.keys(r)),s=a.next();!s.done;s=a.next()){var u=r[s.value];if(u.states)try{for(var h=(n=void 0,c(u.events)),f=h.next();!f.done;f=h.next()){var l=f.value;o.add("".concat(l))}}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter((function(t){return!(!t.target&&!t.actions.length&&t.internal)})).map((function(t){return t.eventType})));return Array.from(t)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(t){var e=this;if(void 0!==t)return t.map((function(t){if(!J(t))return t;var n=t[0]===e.delimiter;if(n&&!e.parent)return e.getStateNodeByPath(t.slice(1));var i=n?e.key+t:t;if(!e.parent)return e.getStateNodeByPath(i);try{return e.parent.getStateNodeByPath(i)}catch(t){throw new Error("Invalid transition definition for state node '".concat(e.id,"':\n").concat(t.message))}}))},e.prototype.formatTransition=function(t){var e=this,n=function(t){if(void 0!==t&&""!==t)return G(t)}(t.target),i="internal"in t?t.internal:!n||n.some((function(t){return J(t)&&t[0]===e.delimiter})),r=this.machine.options.guards,o=this.resolveTarget(n),s=a(a({},t),{actions:ct(G(t.actions)),cond:Y(t.cond,r),target:o,source:this,internal:i,eventType:t.event,toJSON:function(){return a(a({},s),{target:s.target?s.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(e.id)})}});return s},e.prototype.formatTransitions=function(){var e,n,i,r=this;if(this.config.on)if(Array.isArray(this.config.on))i=this.config.on;else{var o=this.config.on,a=Yt,f=o[a],l=void 0===f?[]:f,d=s(o,["symbol"===t(a)?a:"*"]);i=j(Object.keys(d).map((function(t){var e=tt(t,d[t]);return e})).concat(tt(Yt,l)))}else i=[];var p=this.config.always?tt("",this.config.always):[],v=this.config.onDone?tt(String(lt(this.id)),this.config.onDone):[];var y=j(this.invoke.map((function(t){var e=[];return t.onDone&&e.push.apply(e,h([],u(tt(String(dt(t.id)),t.onDone)),!1)),t.onError&&e.push.apply(e,h([],u(tt(String(pt(t.id)),t.onError)),!1)),e}))),g=this.after,m=j(h(h(h(h([],u(v),!1),u(y),!1),u(i),!1),u(p),!1).map((function(t){return G(t).map((function(t){return r.formatTransition(t)}))})));try{for(var w=c(g),b=w.next();!b.done;b=w.next()){var S=b.value;m.push(S)}}catch(t){e={error:t}}finally{try{b&&!b.done&&(n=w.return)&&n.call(w)}finally{if(e)throw e.error}}return m},e}();var Qt=function(t){return{type:g,assignment:t}};function te(t){return function(t){return function(){var e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}(function(t){for(var e=0,n=1779033703^t.length;e<t.length;e++)n=(n=Math.imul(n^t.charCodeAt(e),3432918353))<<13|n>>>19;return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),(n^=n>>>16)>>>0}(t.toString()))}function ee(t){if("number"!=typeof t)throw new Error("Score is not a number. Received: ".concat(typeof t));if(t<0||t>Math.pow(10,9))throw new Error("Score is not between 0 and 1000000000. Received: ".concat(t));if(!Number.isInteger(t))throw new Error("Score is not an integer. Received: ".concat(t))}var ne={enabled:!1},ie=new Set;function re(t){t.gain.value=ne.enabled?0:1,ie.add(t)}var oe=new Map,ae=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"muted");var se=new Set;function ce(t){var e,n;oe.set(t,null===(e=null==ae?void 0:ae.get)||void 0===e?void 0:e.call(t)),null===(n=null==ae?void 0:ae.set)||void 0===n||n.call(t,ne.enabled),se.add(t)}function ue(t){t&&!ne.enabled&&(ne.enabled=!0,function(){var t,e;try{for(var i=n(Array.from(ie)),r=i.next();!r.done;r=i.next())r.value.gain.value=0}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}(),function(){var t,e,i;try{for(var r=n(Array.from(se)),o=r.next();!o.done;o=r.next()){var a=o.value;null===(i=null==ae?void 0:ae.set)||void 0===i||i.call(a,!0)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}()),!t&&ne.enabled&&(ne.enabled=!1,function(){var t,e;try{for(var i=n(Array.from(ie)),r=i.next();!r.done;r=i.next())r.value.gain.value=1}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}(),function(){var t,e,i,r;try{for(var o=n(Array.from(oe.keys())),a=o.next();!a.done;a=o.next()){var s=a.value;null===(i=null==ae?void 0:ae.set)||void 0===i||i.call(s,null!==(r=oe.get(s))&&void 0!==r&&r)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}}())}var he=[];function fe(){var t,e,n=null!==(t=document.getElementById(be("container")))&&void 0!==t?t:document.createElement("div");n.id=be("container"),document.body.appendChild(n);var r=null!==(e=document.getElementById(be("style")))&&void 0!==e?e:document.createElement("style");r.id=be("style"),document.head.appendChild(r),r.innerHTML=de(ve||(ve=i(["\n    #"," {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      z-index: 2147483647;\n      background-color: black;\n      opacity: 0.9;\n      color: #f44336;\n      font-family: sans-serif;\n      font-size: ",";\n      line-height: 1.5;\n      padding: ",";\n    }\n\n    #"," a {\n      color: #fcc4c0;\n    }\n\n    #"," a:hover {\n      color: white;\n    }\n\n    #"," pre {\n      font-family: monospace;\n      margin: 0;\n      color: #fcc4c0;\n      background-color: #222;\n      display: inline-block;\n      padding: "," ",";\n      border-radius: ",";\n    }\n\n    .",":not(:first-child) {\n      padding-top: ",";\n    }\n\n    ."," ."," {\n      font-size: ",";\n      padding: "," 0;\n    }\n\n    ."," ."," > div:not(:first-child) {\n      padding-top: ",";\n    }\n\n    ."," {\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n  "],["\n    #"," {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      z-index: 2147483647;\n      background-color: black;\n      opacity: 0.9;\n      color: #f44336;\n      font-family: sans-serif;\n      font-size: ",";\n      line-height: 1.5;\n      padding: ",";\n    }\n\n    #"," a {\n      color: #fcc4c0;\n    }\n\n    #"," a:hover {\n      color: white;\n    }\n\n    #"," pre {\n      font-family: monospace;\n      margin: 0;\n      color: #fcc4c0;\n      background-color: #222;\n      display: inline-block;\n      padding: "," ",";\n      border-radius: ",";\n    }\n\n    .",":not(:first-child) {\n      padding-top: ",";\n    }\n\n    ."," ."," {\n      font-size: ",";\n      padding: "," 0;\n    }\n\n    ."," ."," > div:not(:first-child) {\n      padding-top: ",";\n    }\n\n    ."," {\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n  "])),be("container"),le(1),le(2.5),be("container"),be("container"),be("container"),le(.2),le(.4),le(.4),be("error"),le(2),be("error"),be("header"),le(1.5),le(.5),be("error"),be("body"),le(.4),be("errorsContainer")),n.innerHTML=pe(ge||(ge=i(['\n    <div class="','">\n      ',"\n    </div>\n  "],['\n    <div class="','">\n      ',"\n    </div>\n  "])),be("errorsContainer"),he.map((function(t){return pe(ye||(ye=i(['<div class="','">\n            <div class="','">','</div>\n            <div class="','">',"</div>\n          </div>"],['<div class="','">\n            <div class="','">','</div>\n            <div class="','">',"</div>\n          </div>"])),be("error"),be("header"),t.header,be("body"),t.body)})).join(""))}function le(t){return"min(".concat(30*t,"pt, ").concat(2*t,"vh)")}var de=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.reduce((function(t,n,i){return t+n+(e[i]||"")}),"")},pe=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.reduce((function(t,n,i){return t+n+(e[i]||"")}),"")};var ve,ye,ge,me,we={};function be(t){return we[t]||(we[t]="_".concat(Math.round(1e9*Math.random()))),we[t]}function Se(t,e){if(void 0===e&&(e=!1),!window.ReactNativeWebView)return window.parent!==window||e?void window.parent.postMessage(t,"*"):(console.error("Games using the Rune SDK must be tested using Rune CLI. See https://github.com/rune/rune-games-cli for instructions."),void function(t,e){(void 0===e?{}:e).replaceLinks&&(t.body=t.body.replace(/(https?:\/\/\S+)/gi,'<a target="_blank" href="$1">$1</a>')),he.find((function(e){return e.header===t.header&&e.body===t.body}))||he.push(t),setTimeout(fe,0)}({header:"⚠ You need to use the Rune CLI to test your game",body:pe(me||(me=i(["\n          <div>\n            Games using the Rune SDK must be tested using the Rune CLI. The CLI\n            simulates running your game inside the Rune app and provides\n            debugging tools. You can install and run the CLI by running these\n            commands in your terminal:\n          </div>\n          <div>\n            <pre>\n","</pre\n            >\n          </div>\n          <div>See https://github.com/rune/rune-games-cli for more info.</div>\n        "],["\n          <div>\n            Games using the Rune SDK must be tested using the Rune CLI. The CLI\n            simulates running your game inside the Rune app and provides\n            debugging tools. You can install and run the CLI by running these\n            commands in your terminal:\n          </div>\n          <div>\n            <pre>\n","</pre\n            >\n          </div>\n          <div>See https://github.com/rune/rune-games-cli for more info.</div>\n        "])),"npm install -g rune-games-cli\ncd yourGameFolder\nrune start")},{replaceLinks:!0}));window.ReactNativeWebView.postMessage(t)}var xe,Ee,_e,Ue=4294967295;function Ae(t,e,n){var i=Math.floor(n/4294967296),r=n;t.setUint32(e,i),t.setUint32(e+4,r)}function Ie(t,e){return 4294967296*t.getInt32(e)+t.getUint32(e+4)}var Oe=("undefined"==typeof process||"never"!==(null===(xe=null===process||void 0===process?void 0:process.env)||void 0===xe?void 0:xe.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function Te(t){for(var e=t.length,n=0,i=0;i<e;){var r=t.charCodeAt(i++);if(0!=(4294967168&r))if(0==(4294965248&r))n+=2;else{if(r>=55296&&r<=56319&&i<e){var o=t.charCodeAt(i);56320==(64512&o)&&(++i,r=((1023&r)<<10)+(1023&o)+65536)}n+=0==(4294901760&r)?3:4}else n++}return n}var Ne=Oe?new TextEncoder:void 0,Re=Oe?"undefined"!=typeof process&&"force"!==(null===(Ee=null===process||void 0===process?void 0:process.env)||void 0===Ee?void 0:Ee.TEXT_ENCODING)?200:0:Ue;var Le=(null==Ne?void 0:Ne.encodeInto)?function(t,e,n){Ne.encodeInto(t,e.subarray(n))}:function(t,e,n){e.set(Ne.encode(t),n)};function ke(t,e,n){for(var i=e,r=i+n,o=[],a="";i<r;){var s=t[i++];if(0==(128&s))o.push(s);else if(192==(224&s)){var c=63&t[i++];o.push((31&s)<<6|c)}else if(224==(240&s)){c=63&t[i++];var u=63&t[i++];o.push((31&s)<<12|c<<6|u)}else if(240==(248&s)){var h=(7&s)<<18|(c=63&t[i++])<<12|(u=63&t[i++])<<6|63&t[i++];h>65535&&(h-=65536,o.push(h>>>10&1023|55296),h=56320|1023&h),o.push(h)}else o.push(s);o.length>=4096&&(a+=String.fromCharCode.apply(String,o),o.length=0)}return o.length>0&&(a+=String.fromCharCode.apply(String,o)),a}var Me=Oe?new TextDecoder:null,Pe=Oe?"undefined"!=typeof process&&"force"!==(null===(_e=null===process||void 0===process?void 0:process.env)||void 0===_e?void 0:_e.TEXT_DECODER)?200:0:Ue;var Ce,De=function(t,e){this.type=t,this.data=e},je=(Ce=function(t,e){return Ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Ce(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ce(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Be=function(t){function e(n){var i=t.call(this,n)||this,r=Object.create(e.prototype);return Object.setPrototypeOf(i,r),Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:e.name}),i}return je(e,t),e}(Error);var Ge={type:-1,encode:function(t){var e,n,i,r;return t instanceof Date?function(t){var e,n=t.sec,i=t.nsec;if(n>=0&&i>=0&&n<=17179869183){if(0===i&&n<=4294967295){var r=new Uint8Array(4);return(e=new DataView(r.buffer)).setUint32(0,n),r}var o=n/4294967296,a=4294967295&n;return r=new Uint8Array(8),(e=new DataView(r.buffer)).setUint32(0,i<<2|3&o),e.setUint32(4,a),r}return r=new Uint8Array(12),(e=new DataView(r.buffer)).setUint32(0,i),Ae(e,4,n),r}((e=t.getTime(),n=Math.floor(e/1e3),i=1e6*(e-1e3*n),r=Math.floor(i/1e9),{sec:n+r,nsec:i-1e9*r})):null},decode:function(t){var e=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:var n=e.getUint32(0);return{sec:4294967296*(3&n)+e.getUint32(4),nsec:n>>>2};case 12:return{sec:Ie(e,4),nsec:e.getUint32(0)};default:throw new Be("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(t.length))}}(t);return new Date(1e3*e.sec+e.nsec/1e6)}},ze=function(){function t(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Ge)}return t.prototype.register=function(t){var e=t.type,n=t.encode,i=t.decode;if(e>=0)this.encoders[e]=n,this.decoders[e]=i;else{var r=1+e;this.builtInEncoders[r]=n,this.builtInDecoders[r]=i}},t.prototype.tryToEncode=function(t,e){for(var n=0;n<this.builtInEncoders.length;n++){if(null!=(i=this.builtInEncoders[n]))if(null!=(r=i(t,e)))return new De(-1-n,r)}for(n=0;n<this.encoders.length;n++){var i,r;if(null!=(i=this.encoders[n]))if(null!=(r=i(t,e)))return new De(n,r)}return t instanceof De?t:null},t.prototype.decode=function(t,e,n){var i=e<0?this.builtInDecoders[-1-e]:this.decoders[e];return i?i(t,e,n):new De(e,t)},t.defaultCodec=new t,t}();function Ve(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Uint8Array.from(t)}var Fe=function(){function e(t,e,n,i,r,o,a,s){void 0===t&&(t=ze.defaultCodec),void 0===e&&(e=void 0),void 0===n&&(n=100),void 0===i&&(i=2048),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),this.extensionCodec=t,this.context=e,this.maxDepth=n,this.initialBufferSize=i,this.sortKeys=r,this.forceFloat32=o,this.ignoreUndefined=a,this.forceIntegerToFloat=s,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(t,e){if(e>this.maxDepth)throw new Error("Too deep objects in depth ".concat(e));null===t?this.encodeNil():void 0===t?this.encodeUndefined():"boolean"==typeof t?this.encodeBoolean(t):"number"==typeof t?this.encodeNumber(t):"string"==typeof t?this.encodeString(t):this.encodeObject(t,e)},e.prototype.ensureBufferSizeToWrite=function(t){var e=this.pos+t;this.view.byteLength<e&&this.resizeBuffer(2*e)},e.prototype.resizeBuffer=function(t){var e=new ArrayBuffer(t),n=new Uint8Array(e),i=new DataView(e);n.set(this.bytes),this.view=i,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeUndefined=function(){this.writeU8(193)},e.prototype.encodeBoolean=function(t){!1===t?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(t){Number.isSafeInteger(t)&&!this.forceIntegerToFloat?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):(this.writeU8(211),this.writeI64(t)):this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))},e.prototype.writeStringHeader=function(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too long string: ".concat(t," bytes in UTF-8"));this.writeU8(219),this.writeU32(t)}},e.prototype.encodeString=function(t){if(t.length>Re){var e=Te(t);this.ensureBufferSizeToWrite(5+e),this.writeStringHeader(e),Le(t,this.bytes,this.pos),this.pos+=e}else{e=Te(t);this.ensureBufferSizeToWrite(5+e),this.writeStringHeader(e),function(t,e,n){for(var i=t.length,r=n,o=0;o<i;){var a=t.charCodeAt(o++);if(0!=(4294967168&a)){if(0==(4294965248&a))e[r++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&o<i){var s=t.charCodeAt(o);56320==(64512&s)&&(++o,a=((1023&a)<<10)+(1023&s)+65536)}0==(4294901760&a)?(e[r++]=a>>12&15|224,e[r++]=a>>6&63|128):(e[r++]=a>>18&7|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128)}e[r++]=63&a|128}else e[r++]=a}}(t,this.bytes,this.pos),this.pos+=e}},e.prototype.encodeObject=function(e,n){var i=this.extensionCodec.tryToEncode(e,this.context);if(null!=i)this.encodeExtension(i);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!==t(e))throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,n)}},e.prototype.encodeBinary=function(t){var e=t.byteLength;if(e<256)this.writeU8(196),this.writeU8(e);else if(e<65536)this.writeU8(197),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too large binary: ".concat(e));this.writeU8(198),this.writeU32(e)}var n=Ve(t);this.writeU8a(n)},e.prototype.encodeArray=function(t,e){var n=t.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var i=0,r=t;i<r.length;i++){var o=r[i];this.doEncode(o,e+1)}},e.prototype.countWithoutUndefined=function(t,e){for(var n=0,i=0,r=e;i<r.length;i++){void 0!==t[r[i]]&&n++}return n},e.prototype.encodeMap=function(t,e){var n=Object.keys(t);this.sortKeys&&n.sort();var i=this.ignoreUndefined?this.countWithoutUndefined(t,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large map object: ".concat(i));this.writeU8(223),this.writeU32(i)}for(var r=0,o=n;r<o.length;r++){var a=o[r],s=t[a];this.ignoreUndefined&&void 0===s||(this.encodeString(a),this.doEncode(s,e+1))}},e.prototype.encodeExtension=function(t){var e=t.data.length;if(1===e)this.writeU8(212);else if(2===e)this.writeU8(213);else if(4===e)this.writeU8(214);else if(8===e)this.writeU8(215);else if(16===e)this.writeU8(216);else if(e<256)this.writeU8(199),this.writeU8(e);else if(e<65536)this.writeU8(200),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too large extension object: ".concat(e));this.writeU8(201),this.writeU32(e)}this.writeI8(t.type),this.writeU8a(t.data)},e.prototype.writeU8=function(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++},e.prototype.writeU8a=function(t){var e=t.length;this.ensureBufferSizeToWrite(e),this.bytes.set(t,this.pos),this.pos+=e},e.prototype.writeI8=function(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++},e.prototype.writeU16=function(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2},e.prototype.writeI16=function(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2},e.prototype.writeU32=function(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4},e.prototype.writeI32=function(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4},e.prototype.writeF32=function(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4},e.prototype.writeF64=function(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8},e.prototype.writeU64=function(t){this.ensureBufferSizeToWrite(8),function(t,e,n){var i=n/4294967296,r=n;t.setUint32(e,i),t.setUint32(e+4,r)}(this.view,this.pos,t),this.pos+=8},e.prototype.writeI64=function(t){this.ensureBufferSizeToWrite(8),Ae(this.view,this.pos,t),this.pos+=8},e}(),We={};function Ke(t){return"".concat(t<0?"-":"","0x").concat(Math.abs(t).toString(16).padStart(2,"0"))}var He=function(){function t(t,e){void 0===t&&(t=16),void 0===e&&(e=16),this.maxKeyLength=t,this.maxLengthPerKey=e,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return t.prototype.canBeCached=function(t){return t>0&&t<=this.maxKeyLength},t.prototype.find=function(t,e,n){t:for(var i=0,r=this.caches[n-1];i<r.length;i++){for(var o=r[i],a=o.bytes,s=0;s<n;s++)if(a[s]!==t[e+s])continue t;return o.str}return null},t.prototype.store=function(t,e){var n=this.caches[t.length-1],i={bytes:t,str:e};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)},t.prototype.decode=function(t,e,n){var i=this.find(t,e,n);if(null!=i)return this.hit++,i;this.miss++;var r=ke(t,e,n),o=Uint8Array.prototype.slice.call(t,e,e+n);return this.store(o,r),r},t}(),qe=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function s(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((i=i.apply(t,e||[])).next())}))},Je=function(t,e){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ye=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}},$e=function(t){return this instanceof $e?(this.v=t,this):new $e(t)},Xe=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||s(t,e)}))})}function s(t,e){try{(n=r[t](e)).value instanceof $e?Promise.resolve(n.value.v).then(c,u):h(o[0][2],n)}catch(t){h(o[0][3],t)}var n}function c(t){s("next",t)}function u(t){s("throw",t)}function h(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}},Ze=new DataView(new ArrayBuffer(0)),Qe=new Uint8Array(Ze.buffer),tn=function(){try{Ze.getInt8(0)}catch(t){return t.constructor}throw new Error("never reached")}(),en=new tn("Insufficient data"),nn=new He,rn=function(){function e(t,e,n,i,r,o,a,s){void 0===t&&(t=ze.defaultCodec),void 0===e&&(e=void 0),void 0===n&&(n=Ue),void 0===i&&(i=Ue),void 0===r&&(r=Ue),void 0===o&&(o=Ue),void 0===a&&(a=Ue),void 0===s&&(s=nn),this.extensionCodec=t,this.context=e,this.maxStrLength=n,this.maxBinLength=i,this.maxArrayLength=r,this.maxMapLength=o,this.maxExtLength=a,this.keyDecoder=s,this.totalPos=0,this.pos=0,this.view=Ze,this.bytes=Qe,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(t){this.bytes=Ve(t),this.view=function(t){if(t instanceof ArrayBuffer)return new DataView(t);var e=Ve(t);return new DataView(e.buffer,e.byteOffset,e.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(t){if(-1!==this.headByte||this.hasRemaining(1)){var e=this.bytes.subarray(this.pos),n=Ve(t),i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),this.setBuffer(i)}else this.setBuffer(t)},e.prototype.hasRemaining=function(t){return this.view.byteLength-this.pos>=t},e.prototype.createExtraByteError=function(t){var e=this.view,n=this.pos;return new RangeError("Extra ".concat(e.byteLength-n," of ").concat(e.byteLength," byte(s) found at buffer[").concat(t,"]"))},e.prototype.decode=function(t){this.reinitializeState(),this.setBuffer(t);var e=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return e},e.prototype.decodeMulti=function(t){return Je(this,(function(e){switch(e.label){case 0:this.reinitializeState(),this.setBuffer(t),e.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return e.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(t){var e,n,i,r;return qe(this,void 0,void 0,(function(){var o,a,s,c,u,h,f,l;return Je(this,(function(d){switch(d.label){case 0:o=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),e=Ye(t),d.label=2;case 2:return[4,e.next()];case 3:if((n=d.sent()).done)return[3,5];if(s=n.value,o)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s);try{a=this.doDecodeSync(),o=!0}catch(t){if(!(t instanceof tn))throw t}this.totalPos+=this.pos,d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=d.sent(),i={error:c},[3,12];case 7:return d.trys.push([7,,10,11]),n&&!n.done&&(r=e.return)?[4,r.call(e)]:[3,9];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(i)throw i.error;return[7];case 11:return[7];case 12:if(o){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,a]}throw h=(u=this).headByte,f=u.pos,l=u.totalPos,new RangeError("Insufficient data in parsing ".concat(Ke(h)," at ").concat(l," (").concat(f," in the current buffer)"))}}))}))},e.prototype.decodeArrayStream=function(t){return this.decodeMultiAsync(t,!0)},e.prototype.decodeStream=function(t){return this.decodeMultiAsync(t,!1)},e.prototype.decodeMultiAsync=function(t,e){return Xe(this,arguments,(function(){var n,i,r,o,a,s,c,u,h;return Je(this,(function(f){switch(f.label){case 0:n=e,i=-1,f.label=1;case 1:f.trys.push([1,13,14,19]),r=Ye(t),f.label=2;case 2:return[4,$e(r.next())];case 3:if((o=f.sent()).done)return[3,12];if(a=o.value,e&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),n&&(i=this.readArraySize(),n=!1,this.complete()),f.label=4;case 4:f.trys.push([4,9,,10]),f.label=5;case 5:return[4,$e(this.doDecodeSync())];case 6:return[4,f.sent()];case 7:return f.sent(),0==--i?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((s=f.sent())instanceof tn))throw s;return[3,10];case 10:this.totalPos+=this.pos,f.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=f.sent(),u={error:c},[3,19];case 14:return f.trys.push([14,,17,18]),o&&!o.done&&(h=r.return)?[4,$e(h.call(r))]:[3,16];case 15:f.sent(),f.label=16;case 16:return[3,18];case 17:if(u)throw u.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){t:for(;;){var e=this.readHeadByte(),n=void 0;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){if(0!==(r=e-128)){this.pushMapState(r),this.complete();continue t}n={}}else if(e<160){if(0!==(r=e-144)){this.pushArrayState(r),this.complete();continue t}n=[]}else{var i=e-160;n=this.decodeUtf8String(i,0)}else if(192===e)n=null;else if(193===e)n=void 0;else if(194===e)n=!1;else if(195===e)n=!0;else if(202===e)n=this.readF32();else if(203===e)n=this.readF64();else if(204===e)n=this.readU8();else if(205===e)n=this.readU16();else if(206===e)n=this.readU32();else if(207===e)n=this.readU64();else if(208===e)n=this.readI8();else if(209===e)n=this.readI16();else if(210===e)n=this.readI32();else if(211===e)n=this.readI64();else if(217===e){i=this.lookU8();n=this.decodeUtf8String(i,1)}else if(218===e){i=this.lookU16();n=this.decodeUtf8String(i,2)}else if(219===e){i=this.lookU32();n=this.decodeUtf8String(i,4)}else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue t}n=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue t}n=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue t}n={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue t}n={}}else if(196===e){var r=this.lookU8();n=this.decodeBinary(r,1)}else if(197===e){r=this.lookU16();n=this.decodeBinary(r,2)}else if(198===e){r=this.lookU32();n=this.decodeBinary(r,4)}else if(212===e)n=this.decodeExtension(1,0);else if(213===e)n=this.decodeExtension(2,0);else if(214===e)n=this.decodeExtension(4,0);else if(215===e)n=this.decodeExtension(8,0);else if(216===e)n=this.decodeExtension(16,0);else if(199===e){r=this.lookU8();n=this.decodeExtension(r,1)}else if(200===e){r=this.lookU16();n=this.decodeExtension(r,2)}else{if(201!==e)throw new Be("Unrecognized type byte: ".concat(Ke(e)));r=this.lookU32();n=this.decodeExtension(r,4)}this.complete();for(var o=this.stack;o.length>0;){var a=o[o.length-1];if(0===a.type){if(a.array[a.position]=n,a.position++,a.position!==a.size)continue t;o.pop(),n=a.array}else{if(1===a.type){if(s=void 0,"string"!==(s=t(n))&&"number"!==s)throw new Be("The type of key must be string or number but "+t(n));if("__proto__"===n)throw new Be("The key __proto__ is not allowed");a.key=n,a.type=2;continue t}if(a.map[a.key]=n,a.readCount++,a.readCount!==a.size){a.key=null,a.type=1;continue t}o.pop(),n=a.map}}return n}var s},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:if(t<160)return t-144;throw new Be("Unrecognized array type byte: ".concat(Ke(t)))}},e.prototype.pushMapState=function(t){if(t>this.maxMapLength)throw new Be("Max length exceeded: map length (".concat(t,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:t,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(t){if(t>this.maxArrayLength)throw new Be("Max length exceeded: array length (".concat(t,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:t,array:new Array(t),position:0})},e.prototype.decodeUtf8String=function(t,e){var n;if(t>this.maxStrLength)throw new Be("Max length exceeded: UTF-8 byte length (".concat(t,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+e+t)throw en;var i,r=this.pos+e;return i=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(t))?this.keyDecoder.decode(this.bytes,r,t):t>Pe?function(t,e,n){var i=t.subarray(e,e+n);return Me.decode(i)}(this.bytes,r,t):ke(this.bytes,r,t),this.pos+=e+t,i},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(t,e){if(t>this.maxBinLength)throw new Be("Max length exceeded: bin length (".concat(t,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(t+e))throw en;var n=this.pos+e,i=this.bytes.subarray(n,n+t);return this.pos+=e+t,i},e.prototype.decodeExtension=function(t,e){if(t>this.maxExtLength)throw new Be("Max length exceeded: ext length (".concat(t,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+e),i=this.decodeBinary(t,e+1);return this.extensionCodec.decode(i,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var t=this.view.getUint8(this.pos);return this.pos++,t},e.prototype.readI8=function(){var t=this.view.getInt8(this.pos);return this.pos++,t},e.prototype.readU16=function(){var t=this.view.getUint16(this.pos);return this.pos+=2,t},e.prototype.readI16=function(){var t=this.view.getInt16(this.pos);return this.pos+=2,t},e.prototype.readU32=function(){var t=this.view.getUint32(this.pos);return this.pos+=4,t},e.prototype.readI32=function(){var t=this.view.getInt32(this.pos);return this.pos+=4,t},e.prototype.readU64=function(){var t,e,n=(t=this.view,e=this.pos,4294967296*t.getUint32(e)+t.getUint32(e+4));return this.pos+=8,n},e.prototype.readI64=function(){var t=Ie(this.view,this.pos);return this.pos+=8,t},e.prototype.readF32=function(){var t=this.view.getFloat32(this.pos);return this.pos+=4,t},e.prototype.readF64=function(){var t=this.view.getFloat64(this.pos);return this.pos+=8,t},e}(),on={};var an,sn,cn="undefined"!=typeof window||"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},un={exports:{}};function hn(t,e){var n,i;return void 0===e&&(e={}),ln(function(t,e){return void 0===e&&(e=We),new Fe(e.extensionCodec,e.context,e.maxDepth,e.initialBufferSize,e.sortKeys,e.forceFloat32,e.ignoreUndefined,e.forceIntegerToFloat).encodeSharedRef(t)}(t,{maxDepth:null!==(n=e.maxDepth)&&void 0!==n?n:10,sortKeys:null===(i=e.sortKeys)||void 0===i||i}))}function fn(t){return e=pn(t),void 0===n&&(n=on),new rn(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength).decode(e);var e,n}an=un,sn=un.exports,function(e){var n=sn,i=an&&an.exports==n&&an,r="object"==t(cn)&&cn;r.global!==r&&r.window!==r||(e=r);var o=function(t){this.message=t};(o.prototype=new Error).name="InvalidCharacterError";var a=function(t){throw new o(t)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,u={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&a("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n,i,r,o=t.length%3,c="",u=-1,h=t.length-o;++u<h;)e=t.charCodeAt(u)<<16,n=t.charCodeAt(++u)<<8,i=t.charCodeAt(++u),c+=s.charAt((r=e+n+i)>>18&63)+s.charAt(r>>12&63)+s.charAt(r>>6&63)+s.charAt(63&r);return 2==o?(e=t.charCodeAt(u)<<8,n=t.charCodeAt(++u),c+=s.charAt((r=e+n)>>10)+s.charAt(r>>4&63)+s.charAt(r<<2&63)+"="):1==o&&(r=t.charCodeAt(u),c+=s.charAt(r>>2)+s.charAt(r<<4&63)+"=="),c},decode:function(t){var e=(t=String(t).replace(c,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&a("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,o="",u=-1;++u<e;)i=s.indexOf(t.charAt(u)),n=r%4?64*n+i:i,r++%4&&(o+=String.fromCharCode(255&n>>(-2*r&6)));return o},version:"1.0.0"};if(n&&!n.nodeType)if(i)i.exports=u;else for(var h in u)u.hasOwnProperty(h)&&(n[h]=u[h]);else e.base64=u}(cn);var ln=function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(String.fromCharCode(t[n]));return un.exports.encode(e.join(""))},dn=function(t){return t.charCodeAt(0)},pn=function(t){return Uint8Array.from(un.exports.decode(t),dn)},vn="RUNE_MSG_V2;";function yn(t,e){return function(t){return"string"==typeof t&&t.startsWith(vn)}(t)&&function(t){return fn(t.slice(vn.length))}(t)[e]||null}function gn(t){return e={runeGameEvent:t},"".concat(vn).concat(hn(e));var e}function mn(t){Se(gn(t))}var wn={onGameInit:"Rune.init()",onGameOver:"Rune.gameOver()",onAppPlay:"onAppPlay",onAppPause:"onAppPause",onAppRestart:"onAppRestart",onAppRequestScore:"onAppRequestScore"};function bn(t){var n,i,r=(n={tsTypes:{},preserveActionOrder:!0,schema:{context:{},events:{}},context:{gamePlayUuid:"UNSET",rng:te(t),restartGame:function(){throw new Error("restartGame is not initialized!")},resumeGame:function(){throw new Error("resumeGame is not initialized!")},getScore:function(){throw new Error("getScore is not initialized!")},pauseGame:function(){throw new Error("pauseGame is not initialized!")}},id:"SDK (v3)",initial:"LOADING",states:{LOADING:{on:{onGameInit:{actions:["ASSIGN_CALLBACKS","SEND_INIT"],target:"INIT"},onGameOver:{target:"ERROR"}}},ERROR:{type:"final",entry:"SEND_ERROR"},INIT:{initial:"PAUSED",states:{PLAYING:{on:{onAppPause:{actions:"CALL_PAUSE_GAME",target:"PAUSED"},onGameOver:{actions:["SEND_GAME_OVER","RESET_DETERMINISTIC_RANDOMNESS"],target:"GAME_OVER"},onAppRestart:{actions:["SEND_SCORE","ASSIGN_GAME_PLAY_UUID","RESET_DETERMINISTIC_RANDOMNESS","CALL_RESTART_GAME"]}}},PAUSED:{on:{onAppPlay:{actions:["ASSIGN_GAME_PLAY_UUID","CALL_RESUME_GAME"],target:"PLAYING"},onGameOver:{target:"#SDK (v3).ERROR"}}},GAME_OVER:{on:{onAppPlay:{actions:["ASSIGN_GAME_PLAY_UUID","CALL_RESTART_GAME"],target:"PLAYING"},onGameOver:{target:"#SDK (v3).ERROR"}}}},on:{onAppRequestScore:{actions:"SEND_SCORE"},onGameInit:{target:"ERROR"}}}}},i={actions:{ASSIGN_CALLBACKS:Qt((function(t,n){return e(e({},t),n)})),RESET_DETERMINISTIC_RANDOMNESS:Qt((function(n){return e(e({},n),{rng:te(t)})})),ASSIGN_GAME_PLAY_UUID:Qt((function(t,n){return e(e({},t),{gamePlayUuid:n.gamePlayUuid})})),CALL_RESUME_GAME:function(t){(0,t.resumeGame)()},CALL_PAUSE_GAME:function(t){(0,t.pauseGame)()},CALL_RESTART_GAME:function(t){(0,t.restartGame)()},SEND_SCORE:function(e){var n=e.gamePlayUuid,i=(0,e.getScore)();ee(i),mn({type:"SCORE",gamePlayUuid:n,score:i,challengeNumber:t})},SEND_INIT:function(t,e){mn({type:"INIT",version:e.version})},SEND_ERROR:function(t,e,n){var i,r=t.gamePlayUuid,o=((null===(i=n.state.history)||void 0===i?void 0:i.toStrings())||[]).slice(-1)[0].split(".").at(-1),a=wn[e.type];mn({type:"ERR",gamePlayUuid:r,errMsg:"Error: Game called ".concat(a," while game was ").concat(o,". Check if your game accidentally called ").concat(a," at the wrong time or multiple times. This may be caused by timeouts or race conditions.")})},SEND_GAME_OVER:function(e){var n=e.gamePlayUuid,i=(0,e.getScore)();ee(i),mn({type:"GAME_OVER",gamePlayUuid:n,score:i,challengeNumber:t})}}},new Zt(n,i)),o=Kt(r);return o.onTransition((function(t,e){if(void 0!==t.changed&&!t.changed){var n=(t.toStrings()||[]).slice(-1)[0];mn({type:"WARNING",gamePlayUuid:t.context.gamePlayUuid,msg:"Received ".concat(e.type," while in ").concat(n)})}})),o.start(),o}function Sn(){new MutationObserver((function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){t instanceof HTMLAudioElement&&ce(t)})),t.removedNodes.forEach((function(t){var e;t instanceof HTMLAudioElement&&(e=t,oe.delete(e),se.delete(e))}))}))})).observe(document,{childList:!0,subtree:!0})}var xn=document.createElement;var En=window.Audio;var _n=Object.getOwnPropertyDescriptor(AudioNode.prototype,"connect");function Un(t){ne.enabled=t,function(){var t,e;try{for(var i=n(Array.from(document.getElementsByTagName("audio"))),r=i.next();!r.done;r=i.next())ce(r.value)}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}(),Sn(),document.createElement=function(t,e){var n=xn.call(this,t,e);return n instanceof HTMLAudioElement&&ce(n),n},window.Audio=function(t){var e=new En(t);return ce(e),e},window.Audio.prototype=En.prototype,Object.defineProperty(HTMLMediaElement.prototype,"muted",{get:function(){var t;return null!==(t=oe.get(this))&&void 0!==t&&t},set:function(t){var e;oe.set(this,t),ne.enabled||null===(e=null==ae?void 0:ae.set)||void 0===e||e.call(this,t)}}),Object.defineProperty(AudioNode.prototype,"connect",e(e({},_n),{value:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0];if(n instanceof AudioDestinationNode){var i=n.context.createGain();return null==_n||_n.value.call(this,i),null==_n||_n.value.apply(i,t),re(i),n}return null==_n?void 0:_n.value.apply(this,t)}}))}var An=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","hypot","log","log10","log1p","log2","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh","trunc"];var In,On={enableInitialOverlayInBrowser:!!(In=new URLSearchParams(window.location.search)).get("enableInitialOverlayInBrowser"),useDocumentForPostMsgs:!!In.get("customPostMessages"),challengeNumber:Number(In.get("challengeNumber"))||1,startMuted:!!In.get("startMuted")},Tn=On.challengeNumber,Nn=On.useDocumentForPostMsgs;!function(t){var e,n,i=t.enableInitialOverlayInBrowser,r=t.startMuted,o=t.sendMsg;void 0===e&&(e=window),e.Math.__RUNE_PRECISION_SET__||(An.forEach((function(t){var n,i;e.Math[t]=(n=e.Math,i=e.Math[t],function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.fround(i.apply(n,t))})})),e.Math.__RUNE_PRECISION_SET__=!0),function(t){window.addEventListener("error",(function(e){return t({type:"WINDOW_ERR",err:{msg:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno}}),!0}));var e=window.alert;window.alert=function(n){t({type:"WINDOW_ALERT",message:n}),e(n)}}(o),1!==document.getElementsByTagName("script").length&&console.warn("%c⚠ Other scripts are imported before the Rune SDK script. Update your index.html file so that the Rune SDK script tag is included before any other scripts. It is also possible that this warning is caused by a script injected by a browser extension or an antivirus program. In that case, you can safely ignore this.","font-size: 16px"),window.localStorage&&window.localStorage.clear(),window.sessionStorage&&window.sessionStorage.clear(),window.ReactNativeWebView&&(window.console.log=function(){},window.console.error=function(){},window.console.warn=function(){}),function(t,e){t&&document.addEventListener("DOMContentLoaded",(function(){var t=document.createElement("div");t.setAttribute("style","top: 0; bottom: 0; left: 0; right: 0; width: 100vw; height: 100vh; position: absolute; z-index: 9999;"),t.addEventListener("click",(function(){t.remove(),e({type:"BROWSER_INITIAL_OVERLAY_CLICKED"})})),document.body.appendChild(t),e({type:"BROWSER_IFRAME_LOADED"})}))}(i,o),Un(r),(n=document.createElement("style")).innerHTML="\n    * {\n      user-select: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n    }\n    input {\n      user-select: auto;\n      -webkit-user-select: auto;\n      -moz-user-select: auto;\n      -ms-user-select: auto;\n    }\n  ",document.head.prepend(n)}({enableInitialOverlayInBrowser:On.enableInitialOverlayInBrowser,startMuted:On.startMuted,sendMsg:mn});var Rn,Ln,kn=function(t){var n=t.challengeNumber,i=bn(n),r={version:"4.11.0",init:function(t){!function(t){var e;if(null===(e=null==t?void 0:t.getScore)||void 0===e?void 0:e.callbackReturnValueNotSupported){var n=t.getScore;t.getScore=function(){return n(),n.score}}}(t),function(t){var e=void 0===t?{}:t,n=e.restartGame,i=e.resumeGame,r=e.pauseGame,o=e.getScore;if("function"!=typeof i)throw new Error("Invalid resumeGame function provided to Rune.init()");if("function"!=typeof r)throw new Error("Invalid pauseGame function provided to Rune.init()");if("function"!=typeof o)throw new Error("Invalid getScore function provided to Rune.init()");if("function"!=typeof n)throw new Error("Invalid restartGame function provided to Rune.init()");ee(o())}(t),i.send("onGameInit",e(e({},t),{version:r.version}))},getChallengeNumber:function(){return n},gameOver:function(){i.send("onGameOver")},deterministicRandom:function(){return i.state.context.rng()}};return{Rune:r,stateMachineService:i}}({challengeNumber:Tn}),Mn=kn.Rune,Pn=kn.stateMachineService;return Rn=Nn,Ln=function(t){return function(e){var n=yn(e.data,"runeGameCommand");if(n){if(!n.type)throw new Error("Received incorrect message: ".concat(n));switch(n.type){case"pauseGame":return t.send("onAppPause");case"requestScore":return t.send("onAppRequestScore");case"restartGame":return t.send("onAppRestart",{gamePlayUuid:n.gamePlayUuid});case"playGame":return t.send("onAppPlay",{gamePlayUuid:n.gamePlayUuid});case"setForceMuteStatus":return ue(n.muted)}}}}(Pn),Rn?document.addEventListener("message",Ln):window.addEventListener("message",Ln),Mn}();
